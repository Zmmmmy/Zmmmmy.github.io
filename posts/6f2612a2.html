<!DOCTYPE html>
<html>
<head hexo-theme='https://volantis.js.org/#'>
  <meta charset="utf-8">
  <!-- SEO相关 -->
  
    
  
  <!-- 渲染优化 -->
  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="HandheldFriendly" content="True" >
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <!-- 页面元数据 -->
  
    <title>SpringBoot - 芝麻盐的博客</title>
  
    <meta name="keywords" content="Spring">
  
  
    <meta name="description" content="这是一篇关于SpringBoot的笔记">
  

  <!-- feed -->
  

  <!-- import meta -->
  

  <!-- link -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13/css/all.min.css">
  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">

  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.css">

  

  

  

  

  <!-- import link -->
  
  
  <link rel='icon' type='image/x-icon' sizes='32x32' href='/img/家园.svg'>
  

  
  
    
<link rel="stylesheet" href="/css/style.css">

  

  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script>

  
  
</head>

<body>
  
  <div id="loading-bar-wrapper">
  <div id="loading-bar"></div>
</div>
<header class="l_header shadow blur">
  <div class='container'>
  <div class='wrapper'>
    <div class='nav-sub'>
      <p class="title"></p>
      <ul class='switcher nav-list-h'>
        <li><a class="s-comment fas fa-comments fa-fw" target="_self" href='javascript:void(0)'></a></li>
        
          <li><a class="s-toc fas fa-list fa-fw" target="_self" href='javascript:void(0)'></a></li>
        
      </ul>
    </div>
		<div class="nav-main">
      
        
        <a class="title flat-box" target="_self" href='/'>
          
          
          
          
            芝麻盐 <b><sup style='color:#3AA757'></sup></b>
          
        </a>
      

			<div class='menu navigation'>
				<ul class='nav-list-h'>
          
          
          
            
            
              <li>
                <a class="flat-box" href=/
                  
                  
                  
                    id="home"
                  >
                  <i class='fas fa-rss fa-fw'></i>博客
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/categories/
                  
                  
                  
                    id="categories"
                  >
                  <i class='fas fa-folder-open fa-fw'></i>分类
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/tags/
                  
                  
                  
                    id="tags"
                  >
                  <i class='fas fa-tags fa-fw'></i>标签
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/comments/
                  
                  
                  
                    id="comments"
                  >
                  <i class='fas fa-comments fa-fw'></i>留言
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/about/
                  
                  
                  
                    id="about"
                  >
                  <i class='fas fa-info-circle fa-fw'></i>关于
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/archives/
                  
                  
                  
                    id="archives"
                  >
                  <i class='fas fa-archive fa-fw'></i>时间线
                </a>
                
              </li>
            
          
          
				</ul>
			</div>

      <div class="m_search">
        <form name="searchform" class="form u-search-form">
          <i class="icon fas fa-search fa-fw"></i>
          <input type="text" class="input u-search-input" placeholder="全站搜索..." />
        </form>
      </div>

			<ul class='switcher nav-list-h'>
				
					<li><a class="s-search fas fa-search fa-fw" target="_self" href='javascript:void(0)'></a></li>
				
				<li>
          <a class="s-menu fas fa-bars fa-fw" target="_self" href='javascript:void(0)'></a>
          <ul class="menu-phone list-v navigation white-box">
            
              
            
              <li>
                <a class="flat-box" href=/
                  
                  
                  
                    id="home"
                  >
                  <i class='fas fa-rss fa-fw'></i>博客
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="flat-box" href=/categories/
                  
                  
                  
                    id="categories"
                  >
                  <i class='fas fa-folder-open fa-fw'></i>分类
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="flat-box" href=/tags/
                  
                  
                  
                    id="tags"
                  >
                  <i class='fas fa-tags fa-fw'></i>标签
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="flat-box" href=/comments/
                  
                  
                  
                    id="comments"
                  >
                  <i class='fas fa-comments fa-fw'></i>留言
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="flat-box" href=/about/
                  
                  
                  
                    id="about"
                  >
                  <i class='fas fa-info-circle fa-fw'></i>关于
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="flat-box" href=/archives/
                  
                  
                  
                    id="archives"
                  >
                  <i class='fas fa-archive fa-fw'></i>时间线
                </a>
                
              </li>
            
          
            
          </ul>
        </li>
			</ul>
		</div>
	</div>
  </div>
</header>

<script>setLoadingBarProgress(40);</script>



  <div class="l_body nocover">
    <div class='body-wrapper'>
      

<div class='l_main'>
  

  
    <article id="post" class="post white-box reveal shadow article-type-post" itemscope itemprop="blogPost">
      


  <section class='meta'>
    
      
      
      <div class="meta" id="header-meta">
        
          
  <h1 class="title">
    <a href="/posts/6f2612a2">
      SpringBoot
    </a>
  </h1>


        
        <div class='new-meta-box'>
          
            
          
            
              
<div class='new-meta-item author'>
  <a href="https://zmmmmy.github.io/" rel="nofollow">
    <img src="/img/头像.jpg">
    <p>芝麻盐</p>
  </a>
</div>

            
          
            
              
  
  <div class='new-meta-item category'>
    <a href='/categories/Spring/' rel="nofollow">
      <i class="fas fa-folder-open fa-fw" aria-hidden="true"></i>
      <p>Spring</p>
    </a>
  </div>


            
          
            
              <div class="new-meta-item date">
  <a class='notlink'>
    <i class="fas fa-calendar-alt fa-fw" aria-hidden="true"></i>
    <p>发布于：Jul 1, 2020</p>
  </a>
</div>

            
          
            
              
  <div class="new-meta-item wordcount">
    <a class='notlink'>
      <i class="fas fa-keyboard fa-fw" aria-hidden="true"></i>
      <p>7.6k words</p>
    </a>
  </div>
  <div class="new-meta-item readtime">
    <a class='notlink'>
      <i class="fas fa-hourglass-half fa-fw" aria-hidden="true"></i>
      <p>33 min</p>
    </a>
  </div>


            
          
            
              

            
          
        </div>
        
          <hr>
        
      </div>
    
  </section>


      <section class="article typo">
        <div class="article-entry" itemprop="articleBody">
          
          <p>这是一篇关于SpringBoot的笔记</p>
<a id="more"></a>

<h4 id="一、SpringBoot启动类的加载"><a href="#一、SpringBoot启动类的加载" class="headerlink" title="一、SpringBoot启动类的加载"></a>一、SpringBoot启动类的加载</h4><hr>
<p><img src="https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200509003942759.png" alt="./SpringBoot/https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200509003942759"></p>
<h4 id="二、配置文件"><a href="#二、配置文件" class="headerlink" title="二、配置文件"></a>二、配置文件</h4><hr>
<h5 id="1-配置文件"><a href="#1-配置文件" class="headerlink" title="1.配置文件"></a>1.配置文件</h5><p>SpringBoot使用一个全局的配置文件，配置文件名字是固定的</p>
<ul>
<li>application.properties</li>
<li>application.yaml</li>
</ul>
<p>配置文件的作用：修改SpringBoot自动配置的默认值</p>
<h5 id="2-YAML-YML"><a href="#2-YAML-YML" class="headerlink" title="2.YAML(YML)"></a>2.YAML(YML)</h5><ol>
<li>格式</li>
</ol>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">key:</span></span><br><span class="line">  <span class="attr">key:</span> <span class="string">value</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>值的写法</li>
</ol>
<ul>
<li>字符串默认不用加单引号或双引号</li>
<li>如果加上<ul>
<li>“ “：双引号，不会转义字符串的特殊字符，特殊字符会表达出本身的意思</li>
<li>‘  ’ ：单引号，会表达出字符串的意思</li>
</ul>
</li>
</ul>
<hr>
<p>对象、map的写法</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">person:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">zmy</span></span><br><span class="line">  <span class="attr">age:</span> <span class="number">25</span></span><br></pre></td></tr></table></figure>

<p>行内写法</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">person:</span> <span class="string">&#123;name:</span> <span class="string">zmy,age:</span> <span class="number">25</span><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>

<hr>
<p>数组（List、Set）</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">list:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">num1</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">num2</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">num3</span></span><br></pre></td></tr></table></figure>

<p>行内写法</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">list:</span> <span class="string">[unm1,num2,num3]</span></span><br></pre></td></tr></table></figure>

<hr>
<p>将配置文件而的值映射到组件中</p>
<p>JavaBean</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span> <span class="comment">//lombok注解</span></span><br><span class="line"><span class="meta">@ToString</span> <span class="comment">//lombok注解</span></span><br><span class="line"><span class="meta">@Component</span> <span class="comment">//将本类加载进Spring容器</span></span><br><span class="line"><span class="meta">@Validated</span> <span class="comment">//JSR303数据校验</span></span><br><span class="line"><span class="meta">@ConfigurationProperties</span>(prefix = <span class="string">"person"</span>) <span class="comment">//告诉SpringBoot将本类中所有属性和配置文件进行绑定</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> ArrayList&lt;String&gt; phone;</span><br><span class="line">    <span class="keyword">private</span> HashMap&lt;String,String&gt; like;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>yml配置文件（idae会有提示，需要加入依赖）</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-configuration-processor<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>yml</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">person:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">zmy</span></span><br><span class="line">  <span class="attr">age:</span> <span class="number">25</span></span><br><span class="line">  <span class="attr">phone:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">iPhone</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">XiaoMi</span></span><br><span class="line">  <span class="attr">like:</span></span><br><span class="line">    <span class="attr">game:</span> <span class="string">LOL</span></span><br><span class="line">    <span class="attr">guitar:</span> <span class="string">YAMAHA</span></span><br></pre></td></tr></table></figure>

<p>properties</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">person.name</span>=<span class="string">zmy</span></span><br><span class="line"><span class="meta">person.age</span>=<span class="string">25</span></span><br><span class="line"><span class="meta">person.phone</span>=<span class="string">iPhone,XiaoMi</span></span><br><span class="line"><span class="meta">person.like.play</span>=<span class="string">LOL</span></span><br><span class="line"><span class="meta">person.like.guitar</span>=<span class="string">YAMAHA</span></span><br></pre></td></tr></table></figure>



<h5 id="3-ConfigurationProperties-和-Value"><a href="#3-ConfigurationProperties-和-Value" class="headerlink" title="3.@ConfigurationProperties  和  @Value"></a>3.@ConfigurationProperties  和  @Value</h5><table>
<thead>
<tr>
<th></th>
<th align="center">@ConfigurationProperties</th>
<th align="center">@Value</th>
</tr>
</thead>
<tbody><tr>
<td>功能</td>
<td align="center">批量注入配置文件中的属性</td>
<td align="center">一个个指定</td>
</tr>
<tr>
<td>松散绑定</td>
<td align="center">支持</td>
<td align="center">不支持</td>
</tr>
<tr>
<td>SpEL</td>
<td align="center">不支持</td>
<td align="center">支持</td>
</tr>
<tr>
<td>JSR303数据校验</td>
<td align="center">支持</td>
<td align="center">不支持</td>
</tr>
<tr>
<td>复杂类型封装</td>
<td align="center">支持</td>
<td align="center">不支持</td>
</tr>
</tbody></table>
<p>@ConfigurationProperties</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@PropertySource</span>(<span class="string">"classpath:person.properties"</span>)</span><br><span class="line"><span class="meta">@ConfigurationProperties</span>( prefix = <span class="string">"person"</span> )</span><br><span class="line"><span class="comment">//@Validated</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> ArrayList&lt;String&gt; phone;</span><br><span class="line">    <span class="keyword">private</span> HashMap&lt;String,String&gt; like;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>@Value</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@PropertySource</span>(<span class="string">"classpath:person.properties"</span>) <span class="comment">//引入指定资源</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;person.name&#125;"</span>) </span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"#&#123;24+1&#125;"</span>) <span class="comment">//SpEL表达式</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> ArrayList&lt;String&gt; phone;</span><br><span class="line">    <span class="keyword">private</span> HashMap&lt;String,String&gt; like;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="4-PropertySource-和-ImportResource"><a href="#4-PropertySource-和-ImportResource" class="headerlink" title="4.@PropertySource    和    @ImportResource"></a>4.@PropertySource    和    @ImportResource</h5><p>@PropertySource：导入指定资源</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@PropertySource</span>(<span class="string">"classpath:person.properties"</span>)	<span class="comment">//引入指定资源</span></span><br><span class="line"><span class="meta">@ConfigurationProperties</span>( prefix = <span class="string">"person"</span> )</span><br><span class="line"><span class="comment">//@Validated</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> ArrayList&lt;String&gt; phone;</span><br><span class="line">    <span class="keyword">private</span> HashMap&lt;String,String&gt; like;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>@ImportResource：导入配置文件</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span> /.<span class="comment">//SpringBoot启动类</span></span><br><span class="line"><span class="meta">@ImportResource</span>(<span class="string">"classpath:beans.xml"</span>) <span class="comment">//导入指定配置文件</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringbootDemo01Application</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(SpringbootDemo01Application<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="5-SpringBoot推荐给容器中添加组件的方式"><a href="#5-SpringBoot推荐给容器中添加组件的方式" class="headerlink" title="5.SpringBoot推荐给容器中添加组件的方式"></a>5.SpringBoot推荐给容器中添加组件的方式</h5><h6 id="全注解方式"><a href="#全注解方式" class="headerlink" title="全注解方式"></a>全注解方式</h6><p>@Configuration：表明当前是一个配置类，代替之前的Spring配置文件</p>
<p>@Bean：将当前的返回值添加到容器中</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyAppConfig</span> </span>&#123;</span><br><span class="line">    <span class="comment">//将当前方法的返回值添加到容器中</span></span><br><span class="line">    <span class="comment">//容器中组件的id就是当前方法名</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> HelloDemo <span class="title">helloDemo</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Bean给容器中添加组件了"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> HelloDemo();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="6-配置文件占位符"><a href="#6-配置文件占位符" class="headerlink" title="6.配置文件占位符"></a>6.配置文件占位符</h5><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">person.name</span>=<span class="string">钟明原$&#123;random.uuid&#125; 随机数</span></span><br><span class="line"><span class="meta">person.age</span>=<span class="string">25</span></span><br><span class="line"><span class="meta">person.phone</span>=<span class="string">iPhone,XiaoMi</span></span><br><span class="line"><span class="meta">person.like.play</span>=<span class="string">$&#123;person.game:LOL&#125;_CS:GO 引用值，并给定默认值</span></span><br><span class="line"><span class="meta">person.like.guitar</span>=<span class="string">$&#123;person.like.play&#125;&amp;YAMAHA 引用值</span></span><br></pre></td></tr></table></figure>



<h5 id="7-Profile多环境"><a href="#7-Profile多环境" class="headerlink" title="7.Profile多环境"></a>7.Profile多环境</h5><h6 id="1-多Profile文件"><a href="#1-多Profile文件" class="headerlink" title="1.多Profile文件"></a>1.多Profile文件</h6><p>我们在编写配置类的时候，文件名可以是  application-{profile}.properties/yml</p>
<p><img src="https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200509094256248.png" alt="./SpringBoot/https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200509094256248"></p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">server.port</span>=<span class="string">8080</span></span><br><span class="line"><span class="meta">spring.profiles.active</span>=<span class="string">dev	激活该环境</span></span><br></pre></td></tr></table></figure>

<h6 id="2-yml支持多文档块方式"><a href="#2-yml支持多文档块方式" class="headerlink" title="2.yml支持多文档块方式"></a>2.yml支持多文档块方式</h6><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8080</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">profiles:</span></span><br><span class="line">    <span class="attr">active:</span> <span class="string">dev</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8083</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">profiles:</span> <span class="string">dev</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8084</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">profiles:</span> <span class="string">prop</span></span><br></pre></td></tr></table></figure>

<h6 id="3-激活指定的profile"><a href="#3-激活指定的profile" class="headerlink" title="3.激活指定的profile"></a>3.激活指定的profile</h6><p><strong>1.使用设置</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200509095717102.png" alt="./SpringBoot/https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200509095717102"></p>
<p><strong>2.使用命令行</strong></p>
<p>先打包</p>
<p>java -jar springboot-demo01-0.0.1-SNAPSHOT.jar –spring.profiles.active=dev</p>
<p><img src="https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200509100243226.png" alt="./SpringBoot/https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200509100243226"></p>
<p><strong>3.使用虚拟机参数</strong></p>
<p>-Dspring.profiles.active=dev</p>
<p><img src="https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200509100534631.png" alt="./SpringBoot/https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200509100534631"></p>
<h6 id="4-配置文件加载位置"><a href="#4-配置文件加载位置" class="headerlink" title="4.配置文件加载位置"></a>4.配置文件加载位置</h6><ul>
<li>file: ./config/</li>
<li>file: ./</li>
<li>file: classpath:/config</li>
<li>file: classpath:/  （默认）</li>
</ul>
<p>优先级由高到低，高优先级的配置会覆盖低优先级的配置。并且会==互补配置==</p>
<p>还可以通过命令行参数的方式指定配置文件</p>
<p>先打包</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">java -jar spring-boot-config-0.0.1-SNAPSHOT.jar </span><br><span class="line">--spring.config.additional-location=D:/application.properties</span><br></pre></td></tr></table></figure>

<h6 id="5-外部配置文件加载顺序"><a href="#5-外部配置文件加载顺序" class="headerlink" title="5.外部配置文件加载顺序"></a>5.外部配置文件加载顺序</h6><p>1.命令行参数</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">java -jar spring-boot-config-0.0.1-SNAPSHOT.jar </span><br><span class="line">--server.port=8089 </span><br><span class="line">--server.servlet.context-path=/test</span><br></pre></td></tr></table></figure>

<p>2.外部和内部的配置文件</p>
<p>==由jar外向jar包内进行寻找==</p>
<p>==优先加载带profiles的配置文件==</p>
<p>1.jar包外部的application-{profiles}.properties/.yml</p>
<p>2.jar内外部的application-{profiles}.properties/.yml</p>
<p>==再加载不带profiles的配置文件==</p>
<p>1.jar包外部的application.properties/.yml</p>
<p>2.jar内外部的application.properties/.yml</p>
<h4 id="三、SpringBoot的自动配置"><a href="#三、SpringBoot的自动配置" class="headerlink" title="三、SpringBoot的自动配置"></a>三、SpringBoot的自动配置</h4><hr>
<p>spring-boot-starter-xxxxx：<strong>导入组件所需要的依赖</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200509135646515.png" alt="./SpringBoot/https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200509135646515"></p>
<h6 id="1-META-INF-spring-factories下的文件"><a href="#1-META-INF-spring-factories下的文件" class="headerlink" title="1.META-INF/spring.factories下的文件"></a><strong>1.META-INF/spring.factories下的文件</strong></h6><p><img src="https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200509135937329.png" alt="./SpringBoot/https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200509135937329"></p>
<h6 id="2-xxxAutoConfiguration"><a href="#2-xxxAutoConfiguration" class="headerlink" title="2.xxxAutoConfiguration"></a><strong>2.xxxAutoConfiguration</strong></h6><p>每一个xxxAutoConfiguration类都是容器中的一个组件，用他们来做自动配置</p>
<p>以<strong>HttpEncodingAutoConfiguration</strong>为例解释自动配置原理</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//表示这是一个自动配置类</span></span><br><span class="line"><span class="meta">@Configuration</span>(proxyBeanMethods = <span class="keyword">false</span>) </span><br><span class="line"><span class="comment">//启用指定类的@ConfigurationProperties功能，将配置文件中的值和HttpProperties绑定起来，并把HttpProperties加入到容器中</span></span><br><span class="line"><span class="meta">@EnableConfigurationProperties</span>(HttpProperties<span class="class">.<span class="keyword">class</span>) </span></span><br><span class="line"><span class="class">//组合疏注解，底层是@<span class="title">Conditiona</span>注解，根据不同条件，如果满足条件，整个配置类里的配置就会生效</span></span><br><span class="line"><span class="class">//判断当前是否为<span class="title">web</span>应用，如果是，当前配置类生效</span></span><br><span class="line"><span class="class">@<span class="title">ConditionalOnWebApplication</span>(<span class="title">type</span> </span>= ConditionalOnWebApplication.Type.SERVLET)</span><br><span class="line"><span class="comment">//判断当前是否有CharacterEncodingFilter类</span></span><br><span class="line"><span class="comment">//CharacterEncodingFilter----&gt;SpringMVC中解决乱码的过滤器</span></span><br><span class="line"><span class="meta">@ConditionalOnClass</span>(CharacterEncodingFilter<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">//判断配置文件中置否存在某个配置：<span class="title">spring</span>.<span class="title">http</span>.<span class="title">encoding</span>.<span class="title">enabled</span>,如果不存在判断也是成立的</span></span><br><span class="line"><span class="class">//即使不配置也是默认生效的：<span class="title">spring</span>.<span class="title">http</span>.<span class="title">encoding</span>.<span class="title">enabled</span></span>=<span class="keyword">true</span></span><br><span class="line"><span class="meta">@ConditionalOnProperty</span>(prefix = <span class="string">"spring.http.encoding"</span>, value = <span class="string">"enabled"</span>, matchIfMissing = <span class="keyword">true</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HttpEncodingAutoConfiguration</span> </span>&#123;</span><br><span class="line">    <span class="comment">//他已经和SPringBoot配置文件映射了</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> HttpProperties.Encoding properties;</span><br><span class="line">   	<span class="comment">//只有一个有参构造器，参数就会从容器中拿到</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">HttpEncodingAutoConfiguration</span><span class="params">(HttpProperties properties)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.properties = properties.getEncoding();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//给容器中添加一个组件，这个组件的值，需要从properties获取</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="comment">//在该组件不存在时生效</span></span><br><span class="line">	<span class="meta">@ConditionalOnMissingBean</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> CharacterEncodingFilter <span class="title">characterEncodingFilter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		CharacterEncodingFilter filter = <span class="keyword">new</span> OrderedCharacterEncodingFilter();</span><br><span class="line">		filter.setEncoding(<span class="keyword">this</span>.properties.getCharset().name());</span><br><span class="line">		filter.setForceRequestEncoding(<span class="keyword">this</span>.properties.shouldForce(Type.REQUEST));</span><br><span class="line">		filter.setForceResponseEncoding(<span class="keyword">this</span>.properties.shouldForce(Type.RESPONSE));</span><br><span class="line">		<span class="keyword">return</span> filter;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>==根据当前不同条件判断，决定这个配置类是否生效==</p>
<p>一旦配置类生效，这个配置类就会为容器添加各种组件，这些组建的属性是从对应的==xxxxProperties==类中获取的</p>
<h6 id="3-xxxxProperties"><a href="#3-xxxxProperties" class="headerlink" title="3.xxxxProperties"></a><strong>3.xxxxProperties</strong></h6><p>xxxxProperties类又和配置文件时绑定的</p>
<p>所有在配置文件中配置的属性都在xxxxProperties类中封装着，配置文件可以配置什么就可以参考对应这个属性</p>
<p><strong>HttpProperties</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ConfigurationProperties</span>(prefix = <span class="string">"spring.http"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HttpProperties</span> </span>&#123;</span><br></pre></td></tr></table></figure>



<h6 id="4-精髓-amp-总结"><a href="#4-精髓-amp-总结" class="headerlink" title="4.精髓&amp;总结"></a><strong>4.精髓</strong>&amp;总结</h6><ul>
<li>SpringBoot启动会加载大量的自动配置类</li>
<li>首先看我们需要的功能SpringBoot有没有自动配置</li>
<li>再来看自动配置类到底配置了那些组件，如果配置了我们需要的组件，就不需要再配置了</li>
<li>给容器中的自动配置类添加组件的时候，会从xxxxProperties类中获取某些属性。我们就可以在配置文件中指定这些属性的值</li>
</ul>
<p><strong>xxxxAutoConfiguration</strong>：自动配置类给容器中添加组件</p>
<p><strong>xxxxProperties</strong>：封装了配置文件中相关的属性</p>
<h6 id="5-Conditional派生注解"><a href="#5-Conditional派生注解" class="headerlink" title="5.@Conditional派生注解"></a>5.@Conditional派生注解</h6><p>@Conditional派生注解（Spring注解版原生的@Conditional作用）<br>作用：必须是@Conditional指定的条件成立，才给容器中添加组件，配置配里面的所有内容才生效；</p>
<table>
<thead>
<tr>
<th>@Conditional扩展注解</th>
<th>作用（判断是否满足当前指定条件）</th>
</tr>
</thead>
<tbody><tr>
<td>@ConditionalOnJava</td>
<td>系统的java版本是否符合要求</td>
</tr>
<tr>
<td>@ConditionalOnBean</td>
<td>容器中存在指定Bean；</td>
</tr>
<tr>
<td>@ConditionalOnMissingBean</td>
<td>容器中不存在指定Bean；</td>
</tr>
<tr>
<td>@ConditionalOnExpression</td>
<td>满足SpEL表达式指定</td>
</tr>
<tr>
<td>@ConditionalOnClass</td>
<td>系统中有指定的类</td>
</tr>
<tr>
<td>@ConditionalOnMissingClass</td>
<td>系统中没有指定的类</td>
</tr>
<tr>
<td>@ConditionalOnSingleCandidate</td>
<td>容器中只有一个指定的Bean，或者这个Bean是首选Bean</td>
</tr>
<tr>
<td>@ConditionalOnProperty</td>
<td>系统中指定的属性是否有指定的值</td>
</tr>
<tr>
<td>@ConditionalOnResource</td>
<td>类路径下是否存在指定资源文件</td>
</tr>
<tr>
<td>@ConditionalOnWebApplication</td>
<td>当前是web环境</td>
</tr>
<tr>
<td>@ConditionalOnNotWebApplication</td>
<td>当前不是web环境</td>
</tr>
<tr>
<td>@ConditionalOnJndi</td>
<td>JNDI存在指定项</td>
</tr>
</tbody></table>
<h6 id="6-自动配置报告"><a href="#6-自动配置报告" class="headerlink" title="6.自动配置报告"></a>6.自动配置报告</h6><p>通过debug=true属性查看配置情况</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#开启SpringBoot的debug</span></span><br><span class="line"><span class="attr">debug</span>=<span class="string">true</span></span><br></pre></td></tr></table></figure>



<h4 id="四、日志"><a href="#四、日志" class="headerlink" title="四、日志"></a>四、日志</h4><h5 id="1-市面上的日志框架"><a href="#1-市面上的日志框架" class="headerlink" title="1.市面上的日志框架"></a><strong>1.市面上的日志框架</strong></h5><p>JUL、JCL、Jboss-logging、logback、log4j、log4j2、slf4j….</p>
<table>
<thead>
<tr>
<th>日志门面  （日志的抽象层）</th>
<th>日志实现</th>
</tr>
</thead>
<tbody><tr>
<td><del>JCL（Jakarta  Commons Logging）</del>    SLF4j（Simple  Logging Facade for Java）    <strong><del>jboss-logging</del></strong></td>
<td>Log4j  JUL（java.util.logging）  Log4j2  <strong>Logback</strong></td>
</tr>
</tbody></table>
<p>左边选一个门面（抽象层）、右边来选一个实现；</p>
<p>日志门面：  SLF4J；</p>
<p>日志实现：Logback；</p>
<p>SpringBoot：底层是Spring框架，Spring框架默认是用JCL；</p>
<p><strong>==SpringBoot选用 SLF4j和logback；==</strong></p>
<h5 id="2-SEL4J的使用"><a href="#2-SEL4J的使用" class="headerlink" title="2.SEL4J的使用"></a>2.SEL4J的使用</h5><hr>
<h6 id="1-如何在系统中使用SLF4J"><a href="#1-如何在系统中使用SLF4J" class="headerlink" title="1.如何在系统中使用SLF4J"></a>1.如何在系统中使用SLF4J</h6><p>以后在开发的时候，不应该直接调用日志的实现类，而是调用日志抽象层里面的方法</p>
<p>给系统里导入slf4j的jar和logback的实现jar</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloWorld</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    Logger logger = LoggerFactory.getLogger(HelloWorld<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    logger.info(<span class="string">"Hello World"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200509170730760.png" alt="./SpringBoot/https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200509170730760"></p>
<p>每一个日志的实现框架都有自己的配置文件。使用slf4j以后，配置文件还是要导入<strong>具体实现框架的配置文件</strong></p>
<h6 id="2-统一日志"><a href="#2-统一日志" class="headerlink" title="2.统一日志"></a>2.统一日志</h6><p>在一个项目中可能存在多个框架这就导致了多个日志框架一起使用的情况</p>
<p>比如Spring用的是Commons-logging，Hibernate用的是jboss-logging………</p>
<p>如何统一日志，即使是别的框架也和我使用同一个日志框架呢</p>
<p><img src="https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200509174048235.png" alt="./SpringBoot/https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200509174048235"></p>
<p>如何让系统中所有的日志都统一到<strong>slf4j</strong></p>
<ol>
<li>将系统中的其他日志框架先排除出去</li>
<li>用中间包替换原有的日志框架</li>
<li>导入slf4j的实现框架</li>
</ol>
<h6 id="3-SpringBoot日志关系"><a href="#3-SpringBoot日志关系" class="headerlink" title="3.SpringBoot日志关系"></a>3.SpringBoot日志关系</h6><p>SpringBoot最基本模块</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.7.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>SpringBoot日志功能启动器</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-logging<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.7.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200509222107687.png" alt="./SpringBoot/https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200509222107687"></p>
<p><strong>总结</strong></p>
<ol>
<li>SpringBoot底层原理使用的是slf4j+logback的方式进行日志记录</li>
<li>SpringBoot也把其他日志替换成了slf4j</li>
<li>中间替换包</li>
</ol>
<h5 id="3-日志的使用"><a href="#3-日志的使用" class="headerlink" title="3.日志的使用"></a>3.日志的使用</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SpeingBootLogApplicationTests</span> </span>&#123;</span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    Logger logger = LoggerFactory.getLogger(getClass());</span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">contextLoads</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	    <span class="comment">//日志的级别</span></span><br><span class="line">        <span class="comment">//由低到高：trace&lt;debug&lt;info&lt;warn&lt;error</span></span><br><span class="line">        <span class="comment">//可以调整输出日志的级别，日志就会在这个级别以后的高级别生效</span></span><br><span class="line">        logger.trace(<span class="string">"这是trace日志"</span>);</span><br><span class="line">        logger.debug(<span class="string">"这是debug日志"</span>);</span><br><span class="line">        /.<span class="comment">//SpringBoot默认使用的是info级别的，也就是root级别</span></span><br><span class="line">        logger.info(<span class="string">"这是info日志"</span>);</span><br><span class="line">        logger.warn(<span class="string">"这是warn日志"</span>);</span><br><span class="line">        logger.error(<span class="string">"这是error日志"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>配置文件</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#设置日志级别</span></span><br><span class="line"><span class="meta">logging.level.com.zmy</span>=<span class="string">trace</span></span><br><span class="line"><span class="comment">#可以指定路径和log文件的名字</span></span><br><span class="line"><span class="comment">#不能与logging.file.path同时使用</span></span><br><span class="line"><span class="meta">logging.file.name</span>=<span class="string">springboot1.log</span></span><br><span class="line"><span class="comment">#不能指定log的名字, 使用缺省值spring.log</span></span><br><span class="line"><span class="comment">#不能与logging.file.name同时使用</span></span><br><span class="line"><span class="comment">#/代表文件磁盘根目录</span></span><br><span class="line"><span class="comment">#logging.file.path=.//SpringBootDemo3/</span></span><br><span class="line"><span class="comment">#在控制台输出日志的格式</span></span><br><span class="line"><span class="meta">logging.pattern.console</span>=<span class="string">%d&#123;yyyy-MM-dd&#125; [ %thread ] - [ %-5level ] [ %logger&#123;50&#125; : %line ] - %msg%n</span></span><br><span class="line"><span class="comment">#在文件输出日志的格式</span></span><br><span class="line"><span class="meta">logging.pattern.file</span>=<span class="string">%d&#123;yyyy-MM-dd&#125; [ %thread ] - [ %-5level ] [ %logger&#123;50&#125; : %line ] -%msg%n</span></span><br></pre></td></tr></table></figure>

<pre><code>--&gt;
%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n
日志输出格式：
    %d表示日期时间，
    %thread表示线程名，
    %-5level：级别从左显示5个字符宽度
    %logger{50} 表示logger名字最长50个字符，否则按照句点分割。 
    %msg：日志消息，
    %n是换行符</code></pre><p>日志配置文件</p>
<table>
<thead>
<tr>
<th align="left">Logging System</th>
<th align="left">Customization</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Logback</td>
<td align="left"><code>logback-spring.xml</code>,<code>logback-spring.groovy</code>,<code>logback.xml</code>,<code>logback.groovy</code></td>
</tr>
<tr>
<td align="left">Log4j2</td>
<td align="left"><code>log4j2-spring.xml</code> or <code>log4j2.xml</code></td>
</tr>
<tr>
<td align="left">JDK (Java Util Logging)</td>
<td align="left"><code>logging.properties</code></td>
</tr>
</tbody></table>
<p><code>logback.xml</code>：直接被日志框架识别</p>
<p><code>logback-spring.xml</code>：日志框架不加载该文件，由SpringBoot加载，可以使用SpringBoot的高级功能</p>
<p>SpringBoot日志高级功能</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">springProfile</span> <span class="attr">name</span>=<span class="string">"dev"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>输出格式<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">springProfile</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">springProfile</span> <span class="attr">name</span>=<span class="string">"!dev"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>输出格式<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">springProfile</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200510005103429.png" alt="./SpringBoot/https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200510005103429"></p>
<h4 id="五、Web开发"><a href="#五、Web开发" class="headerlink" title="五、Web开发"></a>五、Web开发</h4><hr>
<p><strong>WebMvcAutoConfiguration.java</strong></p>
<p><strong>WebMvc自动配置类</strong></p>
<h5 id="1-SpringBoot对静态资源的映射规则"><a href="#1-SpringBoot对静态资源的映射规则" class="headerlink" title="1.SpringBoot对静态资源的映射规则"></a>1.SpringBoot对静态资源的映射规则</h5><p><strong>public enum StaticResourceLocation——–&gt;静态资源的通用位置的枚举类</strong></p>
<p><strong>getResourceLocations——–&gt;获取资源位置</strong></p>
<p><strong>addResourceHandlers——–&gt;添加资源处理程序</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200510111835774.png" alt="./SpringBoot/https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200510111835774"></p>
<h6 id="1-第一种映射规则"><a href="#1-第一种映射规则" class="headerlink" title="1.第一种映射规则"></a>1.第一种映射规则</h6><p>classpath:/META-INF/resources/webjars/</p>
<p>webjars:SpringBoot是通过jar的打包方式，所以静态资源可以以jar包的方式引入</p>
<p>在pom.xml添加依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--引入jquery的webjars--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.webjars<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jquery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>webjar的结构</p>
<p><img src="https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200510113257181.png" alt="./SpringBoot/https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200510113257181"></p>
<h6 id="2-第二种映射规则"><a href="#2-第二种映射规则" class="headerlink" title="2.第二种映射规则"></a>2.第二种映射规则</h6><p>/**  ：访问当前项目任何资源（静态资源文件夹）</p>
<p>任何资源如果没人处理就在一下资源目录寻找</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">classpath:&#x2F;META-INF&#x2F;resources&#x2F;&quot;</span><br><span class="line">&quot;classpath:&#x2F;resources&#x2F;&quot;</span><br><span class="line">&quot;classpath:&#x2F;static&#x2F;&quot;</span><br><span class="line">&quot;classpath:&#x2F;public&#x2F;</span><br><span class="line">&quot;&#x2F;&quot;:当前项目的根路径</span><br></pre></td></tr></table></figure>

<p>比如：localhost:8080/abc  就等于去静态资源文件夹里找abc</p>
<h6 id="3-资源设置类"><a href="#3-资源设置类" class="headerlink" title="3.资源设置类"></a>3.资源设置类</h6><p>ResourceProperties.java：</p>
<p>资源设置类：可以对资源进行设置</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//可以设置和资源有关的设置</span></span><br><span class="line"><span class="meta">@ConfigurationProperties</span>(prefix = <span class="string">"spring.resources"</span>, ignoreUnknownFields = <span class="keyword">false</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ResourceProperties</span> </span>&#123;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spring.resources.static-locations=设置静态资源路径</span><br></pre></td></tr></table></figure>



<h5 id="2-欢迎页映射"><a href="#2-欢迎页映射" class="headerlink" title="2.欢迎页映射"></a>2.欢迎页映射</h5><p><img src="https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200511001808591.png" alt="./SpringBoot/https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200511001808591"></p>
<h5 id="3-模板引擎"><a href="#3-模板引擎" class="headerlink" title="3.模板引擎"></a>3.模板引擎</h5><p>JSP、Velocity、Freemarker、Thymeleaf……..</p>
<p><img src="https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200511002914699.png" alt="./SpringBoot/https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200511002914699"></p>
<p>SpringBoot推荐使用Thymeleaf</p>
<h6 id="1-引入Thymeleaf"><a href="#1-引入Thymeleaf" class="headerlink" title="1.引入Thymeleaf"></a>1.引入Thymeleaf</h6><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-thymeleaf<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ThymeleafProperties配置类</p>
<p>加载classpath:/templates/xxxxx.html下的文件</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ConfigurationProperties</span>(prefix = <span class="string">"spring.thymeleaf"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThymeleafProperties</span> </span>&#123;</span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Charset DEFAULT_ENCODING = StandardCharsets.UTF_8;</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_PREFIX = <span class="string">"classpath:/templates/"</span>;</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_SUFFIX = <span class="string">".html"</span>;</span><br></pre></td></tr></table></figure>



<h6 id="2-使用Thymeleaf"><a href="#2-使用Thymeleaf" class="headerlink" title="2.使用Thymeleaf"></a>2.使用Thymeleaf</h6><p>引入命名空间</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span> <span class="attr">xmlns:th</span>=<span class="string">"http://www.thymeleaf.org"</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h6 id="3-Thymeleaf语法规则"><a href="#3-Thymeleaf语法规则" class="headerlink" title="3.Thymeleaf语法规则"></a>3.Thymeleaf语法规则</h6><p><img src="https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200511013130844.png" alt="./SpringBoot/https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200511013130844"></p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">Variable</span> <span class="string">Expressions: $&#123;...&#125;	</span></span><br><span class="line"><span class="comment">#获取变量值</span></span><br><span class="line"><span class="comment">#获取对象属性、调用方法</span></span><br><span class="line"><span class="comment">#使用内置对象</span></span><br><span class="line">								</span><br><span class="line"><span class="attr">Selection</span> <span class="string">Variable Expressions: *&#123;...&#125;</span></span><br><span class="line"><span class="comment">#变量选择表达式</span></span><br><span class="line"><span class="comment">#功能上和$&#123;...&#125;一样</span></span><br><span class="line"><span class="comment">#配合th:object使用</span></span><br><span class="line"><span class="meta">&lt;div</span> <span class="string">th:object="$&#123;session.user&#125;"&gt;</span></span><br><span class="line">	<span class="meta">&lt;p&gt;Name</span>: <span class="string">&lt;span th:text="*&#123;firstName&#125;"&gt;Sebastian&lt;/span&gt;.&lt;/p&gt;</span></span><br><span class="line">	<span class="meta">&lt;p&gt;Surname</span>: <span class="string">&lt;span th:text="*&#123;lastName&#125;"&gt;Pepper&lt;/span&gt;.&lt;/p&gt;</span></span><br><span class="line">	<span class="meta">&lt;p&gt;Nationality</span>: <span class="string">&lt;span th:text="*&#123;nationality&#125;"&gt;Saturn&lt;/span&gt;.&lt;/p&gt;</span></span><br><span class="line"><span class="attr">&lt;/div&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Message</span> <span class="string">Expressions: #&#123;...&#125;</span></span><br><span class="line"><span class="comment">#获取国际化内容</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Link</span> <span class="string">URL Expressions: @&#123;...&#125;</span></span><br><span class="line"><span class="comment">#定义url</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Fragment</span> <span class="string">Expressions: ~&#123;...&#125;</span></span><br><span class="line"><span class="comment">#引用表达式</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Text</span> <span class="string">literals: , ,…'one text''Another one!'</span></span><br><span class="line"><span class="attr">Number</span> <span class="string">literals: , , , ,…0343.012.3</span></span><br><span class="line"><span class="attr">Boolean</span> <span class="string">literals: , truefalse</span></span><br><span class="line"><span class="attr">Null</span> <span class="string">literal: null</span></span><br><span class="line"><span class="attr">Literal</span> <span class="string">tokens: , , ,…onesometextmain</span></span><br><span class="line"></span><br><span class="line"><span class="attr">String</span> <span class="string">concatenation: +</span></span><br><span class="line"><span class="attr">Literal</span> <span class="string">substitutions: |The name is $&#123;name&#125;|</span></span><br><span class="line"><span class="attr">Arithmetic</span> <span class="string">operations:</span></span><br><span class="line"><span class="attr">Binary</span> <span class="string">operators: , , , , +-*/%</span></span><br><span class="line"><span class="attr">Minus</span> <span class="string">sign (unary operator): -</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Binary</span> <span class="string">operators: , andor</span></span><br><span class="line"><span class="attr">Boolean</span> <span class="string">negation (unary operator): , !not</span></span><br><span class="line"><span class="attr">Comparisons</span> <span class="string">and equality:</span></span><br><span class="line"><span class="attr">Comparators</span>: <span class="string">, , , (, , , &gt;&lt;&gt;=&lt;=gtltgele)</span></span><br><span class="line"><span class="attr">Equality</span> <span class="string">operators: , (, ==!=eqne)</span></span><br><span class="line"><span class="attr">Conditional</span> <span class="string">operators:</span></span><br><span class="line"><span class="meta">If-then</span>: <span class="string">(if) ? (then)</span></span><br><span class="line"><span class="meta">If-then-else</span>: <span class="string">(if) ? (then) : (else)</span></span><br><span class="line"><span class="attr">Default</span>: <span class="string">(value) ?: (defaultvalue)</span></span><br><span class="line"><span class="attr">Special</span> <span class="string">tokens:</span></span><br><span class="line"><span class="meta">No-Operation</span>: <span class="string">_</span></span><br></pre></td></tr></table></figure>

<p>[[标签内容]]：不转义</p>
<p>[(标签内容)]：转义</p>
<h6 id="4-重定向与转发"><a href="#4-重定向与转发" class="headerlink" title="4.重定向与转发"></a>4.重定向与转发</h6><p><img src="https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200512154105180.png" alt="./SpringBoot/https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200512154105180"></p>
<h5 id="4-Spring-MVC自动配置"><a href="#4-Spring-MVC自动配置" class="headerlink" title="4.Spring MVC自动配置"></a>4.Spring MVC自动配置</h5><p>Spring MVC核心组件</p>
<p>DispatcherServlet：调度器</p>
<p>ViewResolver：视图解析器</p>
<p><strong>Spring MVC Auto-configuration</strong></p>
<p>以下是SpringBoot对SpringMVC的自动配置</p>
<ul>
<li><p>Inclusion of <code>ContentNegotiatingViewResolver</code> and <code>BeanNameViewResolver</code> beans.</p>
<ul>
<li><p>自动配置了ViewResolver（视图解析器，根据返回值返回视图对象）</p>
</li>
<li><p>ContentNegotiatingViewResolver ：组合所有视图解析器</p>
</li>
<li><p>如何定制：我们可以自己给容器中添加一个视图解析器==添加到容器==ContentNegotiatingViewResolver 就会自动的将其组合进来      验证：———&gt;DispatcherServlet——–&gt;doDispatch，查看是否加入</p>
</li>
<li><pre><code class="java"><span class="meta">@Bean</span>
<span class="function"><span class="keyword">public</span> ViewResolver <span class="title">myViewResolver</span><span class="params">()</span></span>{
    <span class="keyword">return</span> <span class="keyword">new</span> MyViewResolver();
}
<span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MyViewResolver</span> <span class="keyword">implements</span> <span class="title">ViewResolver</span></span>{

    <span class="meta">@Override</span>
    <span class="function"><span class="keyword">public</span> View <span class="title">resolveViewName</span><span class="params">(String viewName, Locale locale)</span> <span class="keyword">throws</span> Exception </span>{
        <span class="keyword">return</span> <span class="keyword">null</span>;
    }
}
&lt;!--￼<span class="number">36</span>--&gt;
</code></pre>
</li>
</ul>
</li>
</ul>
<p>==<strong>SpringBoot扩展方式</strong>==</p>
<p>编写一个配置类（@Configuration），是==WebMvcConfigurer==类型的，不能标注@EanableWebMvc</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//视图控制器</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyMvcConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</span><br><span class="line">    <span class="comment">//添加视图解析器</span></span><br><span class="line">    <span class="comment">//将/zmy映射到success</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addViewControllers</span><span class="params">(ViewControllerRegistry registry)</span> </span>&#123;</span><br><span class="line">        registry.addViewController(<span class="string">"/zmy"</span>).setViewName(<span class="string">"success"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h6 id="2-SpringMVC的自动配置原理"><a href="#2-SpringMVC的自动配置原理" class="headerlink" title="2.SpringMVC的自动配置原理"></a>2.SpringMVC的自动配置原理</h6><p>WebMvcAutoConfiguration是SpringMVC的自动配置类</p>
<p>WebMvcAutoConfigurationAdapter：Web Mvc自动配置适配器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span>(proxyBeanMethods = <span class="keyword">false</span>)</span><br><span class="line"><span class="meta">@Import</span>(EnableWebMvcConfiguration<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">@<span class="title">EnableConfigurationProperties</span>(</span>&#123; WebMvcProperties<span class="class">.<span class="keyword">class</span>, <span class="title">ResourceProperties</span>.<span class="title">class</span> &#125;)</span></span><br><span class="line"><span class="class">@<span class="title">Order</span>(0)</span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">static</span> <span class="title">class</span> <span class="title">WebMvcAutoConfigurationAdapter</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</span><br></pre></td></tr></table></figure>

<p>@Import(EnableWebMvcConfiguration.class)</p>
<p><img src="https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200511144948441.png" alt="./SpringBoot/https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200511144948441"></p>
<p>效果：有的WebMVC的配置一起起作用</p>
<h6 id="3-全面接管SpringBootMVC"><a href="#3-全面接管SpringBootMVC" class="headerlink" title="3.全面接管SpringBootMVC"></a>3.全面接管SpringBootMVC</h6><p>SpringBoot对SpringMVC的自动配置都不需要了，所有的都是自己来配置</p>
<p>If you want to take complete control of Spring MVC, you can add your own <code>@Configuration</code> annotated with <code>@EnableWebMvc</code>, or alternatively add your own <code>@Configuration</code>-annotated <code>DelegatingWebMvcConfiguration</code> as described in the Javadoc of <code>@EnableWebMvc</code>.</p>
<p>如果要完全控制Spring MVC，可以添加带有@EnableWebMvc注释的自己的@Configuration，或者添加自己的@Configuration注释的DelegatingWebMvcConfiguration，如@EnableWebMvc的Javadoc中所述。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200511151239267.png" alt="./SpringBoot/https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200511151239267"></p>
<h5 id="5-如何修改SpringBoot的默认配置"><a href="#5-如何修改SpringBoot的默认配置" class="headerlink" title="==5.如何修改SpringBoot的默认配置=="></a>==5.如何修改SpringBoot的默认配置==</h5><p><strong>org.springframework.boot.autoconfigure.web：</strong>web的所有自动配置场景；</p>
<p>模式：</p>
<ol>
<li>SpringBoot在自动配置类，先看容器中有没有用户自己注册进去的组件        （@ConditionalOnMissingBean），如果有就用用户配置的，没有就自动配置。如果有组件可以有多个就将用户配置的，和默认配置的结合起来（ViewResolver）</li>
<li>在SpringBoot中有非常多的xxxxConfigurer帮助我们进行扩展配置，比如==WebMvcConfigurer==</li>
<li>在SpringBoot中有非常多的xxxxCustomizer帮助我们进行定制配置，比如==WebServerFactoryCustomizer==</li>
</ol>
<h4 id="六、RestfulCRUD"><a href="#六、RestfulCRUD" class="headerlink" title="六、RestfulCRUD"></a>六、RestfulCRUD</h4><hr>
<h5 id="1-默认访问首页（视图控制器）"><a href="#1-默认访问首页（视图控制器）" class="headerlink" title="1.默认访问首页（视图控制器）"></a>1.默认访问首页（视图控制器）</h5><p>视图控制器</p>
<p>须在WebMvc配置类添加</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addViewControllers</span><span class="params">(ViewControllerRegistry registry)</span> </span>&#123;</span><br><span class="line">        registry.addViewController(<span class="string">"/index.html"</span>).setViewName(<span class="string">"index"</span>);</span><br><span class="line">        registry.addViewController(<span class="string">"/"</span>).setViewName(<span class="string">"index"</span>);</span><br><span class="line">        registry.addViewController(<span class="string">"/index"</span>).setViewName(<span class="string">"index"</span>);</span><br><span class="line">        registry.addViewController(<span class="string">"/main.html"</span>).setViewName(<span class="string">"dashboard"</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>



<h5 id="2-国际化"><a href="#2-国际化" class="headerlink" title="2.国际化"></a>2.国际化</h5><ol>
<li>编写国际化配置文件</li>
<li>使用ResourceBundleMessageSource管理国际化资源文件</li>
<li>在页面使用fmt:message取出国际化内容</li>
</ol>
<p><strong>步骤：</strong></p>
<ol>
<li>编写国际化配置文件，抽取页面要显示的国际化消息</li>
</ol>
<p>国际化配置文件</p>
<p><img src="https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200511175647814.png" alt="./SpringBoot/https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200511175647814"></p>
<ol start="2">
<li>SpringBoot已经自动配置好了ResourceBundleMessageSource国际化资源管理组件</li>
</ol>
<p><img src="https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200511194641641.png" alt="./SpringBoot/https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200511194641641"></p>
<ol start="3">
<li>在页面获取国际化内容：使用#{………}获取国际化内容</li>
<li>根据浏览器语言设置页面语言<ul>
<li>原理：<ul>
<li>Locale（区域信息对象），</li>
<li>LocaleResolver（语言环境解析器）</li>
</ul>
</li>
</ul>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//WebMvcAutoConfiguration.java</span></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="meta">@ConditionalOnMissingBean</span>  <span class="comment">//判断是否有该组件</span></span><br><span class="line"><span class="meta">@ConditionalOnProperty</span>(prefix = <span class="string">"spring.mvc"</span>, name = <span class="string">"locale"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> LocaleResolver <span class="title">localeResolver</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//判断，如果mvcProperties（mvc配置文件里的getLocaleResolver）等于LocaleResolver.FIXED（固定的），使用固定的值</span></span><br><span class="line">   <span class="keyword">if</span> (<span class="keyword">this</span>.mvcProperties.getLocaleResolver() == WebMvcProperties.LocaleResolver.FIXED) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> FixedLocaleResolver(<span class="keyword">this</span>.mvcProperties.getLocale());</span><br><span class="line">   &#125;</span><br><span class="line">    <span class="comment">//使用请求头中的国际化信息</span></span><br><span class="line">   AcceptHeaderLocaleResolver localeResolver = <span class="keyword">new</span> AcceptHeaderLocaleResolver();</span><br><span class="line">   localeResolver.setDefaultLocale(<span class="keyword">this</span>.mvcProperties.getLocale());</span><br><span class="line">   <span class="keyword">return</span> localeResolver;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//如果请求头没有带国际化信息就用默认的</span></span><br><span class="line"><span class="comment">//请求头带了信息，就用请求头的</span></span><br></pre></td></tr></table></figure>



<h5 id="3-登录页面"><a href="#3-登录页面" class="headerlink" title="3.登录页面"></a>3.登录页面</h5><p>开发期间模板引擎修改以后，要实时生效</p>
<ol>
<li>Ctrl+F9重新编译页面</li>
<li>禁用模板引擎的缓存：spring.thymeleaf.cache=false</li>
</ol>
<h5 id="4-拦截器"><a href="#4-拦截器" class="headerlink" title="4.拦截器"></a>4.拦截器</h5><ol>
<li>实现HandlerInterceptor接口</li>
<li>在WebMvc配置类里添加拦截器</li>
<li>拦截器会过滤静态资源，需放行</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginHandlerInterceptor</span> <span class="keyword">implements</span> <span class="title">HandlerInterceptor</span> </span>&#123;</span><br><span class="line">    <span class="comment">//目标方法执行之前</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse 	response, Object handler)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        HttpSession session = request.getSession();</span><br><span class="line">        Object user = session.getAttribute(<span class="string">"user"</span>);</span><br><span class="line">        <span class="keyword">if</span> (user==<span class="keyword">null</span>)&#123;</span><br><span class="line">            request.setAttribute(<span class="string">"msg"</span>,<span class="string">"没有权限"</span>);</span><br><span class="line">            request.getRequestDispatcher(<span class="string">"/index.html"</span>).forward(request,response);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">postHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//目标方法执行之后</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> </span>&#123;</span><br><span class="line">    registry.addInterceptor(<span class="keyword">new</span> LoginHandlerInterceptor()).addPathPatterns(<span class="string">"/**"</span>)</span><br><span class="line">    .excludePathPatterns(<span class="string">"/index.html"</span>,<span class="string">"/index"</span>,<span class="string">"/"</span>,<span class="string">"/user/login"</span>,<span class="string">"/asserts/**"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="5-Restful风格"><a href="#5-Restful风格" class="headerlink" title="5.Restful风格"></a>5.Restful风格</h5><p><strong>路径格式：URI:/资源名称/资源标识</strong></p>
<table>
<thead>
<tr>
<th align="center"></th>
<th align="center">普通</th>
<th align="center">Restful</th>
</tr>
</thead>
<tbody><tr>
<td align="center">查询</td>
<td align="center">getXXX</td>
<td align="center">XXX—GET</td>
</tr>
<tr>
<td align="center">添加</td>
<td align="center">addXXX?xxx</td>
<td align="center">XXX—POST</td>
</tr>
<tr>
<td align="center">修改</td>
<td align="center">updateXXX?id=xxx&amp;xxx=xxx</td>
<td align="center">XXX/{id}—PUT</td>
</tr>
<tr>
<td align="center">删除</td>
<td align="center">deleteXXX?id=xxx</td>
<td align="center">XXX/{id}—DELETE</td>
</tr>
</tbody></table>
<p>实验要求的请求架构</p>
<table>
<thead>
<tr>
<th align="left"></th>
<th align="center">请求URI</th>
<th align="center">请求方式</th>
</tr>
</thead>
<tbody><tr>
<td align="left">查询所有员工</td>
<td align="center">emps</td>
<td align="center">GET</td>
</tr>
<tr>
<td align="left">查询某个员工</td>
<td align="center">emp/{id}</td>
<td align="center">GET</td>
</tr>
<tr>
<td align="left">来到添加页面</td>
<td align="center">emp</td>
<td align="center">GET</td>
</tr>
<tr>
<td align="left">添加员工</td>
<td align="center">emp</td>
<td align="center">POST</td>
</tr>
<tr>
<td align="left">来到修改页面（回显）</td>
<td align="center">emp/{id}</td>
<td align="center">GET</td>
</tr>
<tr>
<td align="left">修改</td>
<td align="center">emp</td>
<td align="center">PUT</td>
</tr>
<tr>
<td align="left">删除员工</td>
<td align="center">emp/{id}</td>
<td align="center">DELETE</td>
</tr>
</tbody></table>
<h5 id="6-发送PUT-DELETE请求"><a href="#6-发送PUT-DELETE请求" class="headerlink" title="6.发送PUT,DELETE请求"></a>6.发送PUT,DELETE请求</h5><ol>
<li>表单的提交方式为POST</li>
<li>有”_method”的标签</li>
<li>type=”hidden”</li>
<li>value为请求方式</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">name</span>=<span class="string">"_method"</span> <span class="attr">value</span>=<span class="string">"put"</span> <span class="attr">th:if</span>=<span class="string">"$&#123;emp!=null&#125;"</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200512170300499.png" alt="./SpringBoot/https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200512170300499"></p>
<h4 id="七、错误页面"><a href="#七、错误页面" class="headerlink" title="七、错误页面"></a>七、错误页面</h4><hr>
<p><strong>可以参考ErrorMvcAutoConfiguration错误处理自动配置</strong></p>
<p>给容器中添加了以下组件</p>
<ol>
<li><p>DefaultErrorAttributes</p>
<p>帮我们在页面共享信息,可以用这些属性定制页面</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>status：[[$&#123;status&#125;]]<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>timestamp：[[$&#123;timestamp&#125;]]<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol>
<li>timestamp：时间戳</li>
<li>status：状态码</li>
<li>error：错误提示</li>
<li>exception：异常对象</li>
<li>message：异常消息</li>
<li>errors：JSR303数据校验的错误</li>
</ol>
</li>
<li><p>BasicErrorController</p>
<p>基本错误视图控制器，注册错误视图，往里面加错误信息</p>
</li>
<li><p>ErrorPageCustomizer</p>
<p>错误页面定制器，寻找错误页面位置</p>
</li>
<li><p>DefaultErrorViewResolver</p>
<p>寻找匹配的页面/error下的404.html、4xx.html…………….</p>
</li>
</ol>
<p>步骤：</p>
<p>一但系统出现4XX或者5XX之类的错误；ErrorPageCustomizer就会生效（定制错误响应规则）；就会来到/error请求；就会被BasicErrorController处理；去哪个页面就会被DefaultErrorViewResolver解析处理</p>
<img src="../../../../../../../../文件/MyBlog/source/_posts/New-SpringBoo/SpringBoot/https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200513015818937.png" alt="./SpringBoot/https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200513015818937" style="zoom: 200%;">



<h4 id="八、定制错误信息"><a href="#八、定制错误信息" class="headerlink" title="八、定制错误信息"></a>八、定制错误信息</h4><hr>
<h5 id="1-异常处理"><a href="#1-异常处理" class="headerlink" title="1.异常处理"></a>1.异常处理</h5><ol>
<li>@ControllerAdvice：全局异常处理<ol>
<li>@ExceptionHandler ：注解用来指明异常的处理类型</li>
<li>这样只能返回JSON的数据，不能区分客户端和浏览器</li>
<li><img src="https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200513114726259.png" alt="./SpringBoot/https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200513114726259"></li>
</ol>
</li>
</ol>
<h5 id="2-如何自适应浏览器和客户端"><a href="#2-如何自适应浏览器和客户端" class="headerlink" title="2.如何自适应浏览器和客户端"></a><strong>2.如何自适应浏览器和客户端</strong></h5><ul>
<li><p>使用转发return “forward:/error”；让SpringBoot处理</p>
<ul>
<li><p>因为SpringBoot处理/error请求时要获取状态码所以我们自己的错误处理器要加上，否则相应的是200</p>
</li>
<li><pre><code class="java">request.setAttribute(<span class="string">"javax.servlet.error.status_code"</span>,<span class="number">500</span>);
&lt;!--￼<span class="number">45</span>--&gt;


</code></pre>
</li>
</ul>
</li>
</ul>
<h6 id="2-第二种方式"><a href="#2-第二种方式" class="headerlink" title="2.第二种方式"></a>2.第二种方式</h6><p>继承DefaultErrorAttributes并复写getErrorAttributes（获取错误属性）方法，这样既可以得到自己编写的错误信息，也可以得到SpringBoot为我们提供的Attributes。</p>
<p><strong>原理</strong></p>
<p>SpringBoot获取错误信息的方式</p>
<p>进入/error请求BasicErrorController就会处理请求，所以如果想要加入自己的错误信息，只要继承父类，然后覆写DefaultErrorAttributes即可</p>
<p><img src="https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200513153249103.png" alt="./SpringBoot/https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200513153249103"></p>
<h4 id="九、配置嵌入式Servlet容器"><a href="#九、配置嵌入式Servlet容器" class="headerlink" title="九、配置嵌入式Servlet容器"></a>九、配置嵌入式Servlet容器</h4><h6 id="1-修改Web容器配置"><a href="#1-修改Web容器配置" class="headerlink" title="1.修改Web容器配置"></a>1.修改Web容器配置</h6><p>SpringBoot默认使用的是嵌入式Servlet容器（Tomcat）；</p>
<p>SpringBoot默认使用TomCat作为Servlet容器</p>
<p><img src="https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200513162936766.png" alt="./SpringBoot/https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200513162936766"></p>
<ol>
<li><p>如何定制和修改Servlet容器相关配置</p>
<ol>
<li>修改和server相关的配置（ServerProperties）</li>
</ol>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">server.port</span>=<span class="string">8080</span></span><br><span class="line"><span class="meta">server.servlet.context-path</span>=<span class="string">/zmy</span></span><br><span class="line"><span class="comment">#Tomcat相关配置</span></span><br><span class="line"><span class="meta">server.tomcat.xxxx</span>=<span class="string"></span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>编写一个WebServerFactoryCustomizer来修改容器的配置</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> WebServerFactoryCustomizer&lt;ConfigurableWebServerFactory&gt; <span class="title">webServerFactoryCustomizer</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> WebServerFactoryCustomizer&lt;ConfigurableWebServerFactory&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">customize</span><span class="params">(ConfigurableWebServerFactory factory)</span> </span>&#123;</span><br><span class="line">            factory.setPort(<span class="number">8083</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



</li>
</ol>
<h6 id="2-注册三大组件"><a href="#2-注册三大组件" class="headerlink" title="2.注册三大组件"></a>2.注册三大组件</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Server的一些配置</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyServerConfig</span> </span>&#123;</span><br><span class="line">    <span class="comment">//配置TomCat</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> WebServerFactoryCustomizer&lt;ConfigurableWebServerFactory&gt; <span class="title">webServerFactoryCustomizer</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> WebServerFactoryCustomizer&lt;ConfigurableWebServerFactory&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">customize</span><span class="params">(ConfigurableWebServerFactory factory)</span> </span>&#123;</span><br><span class="line">                factory.setPort(<span class="number">8083</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//添加一个Servlet</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ServletRegistrationBean&lt;HttpServlet&gt; <span class="title">myServletServletRegistrationBean</span><span class="params">()</span></span>&#123;</span><br><span class="line">        ServletRegistrationBean&lt;HttpServlet&gt; servletBean = <span class="keyword">new</span> ServletRegistrationBean&lt;HttpServlet&gt;(<span class="keyword">new</span> MyServlet());</span><br><span class="line">        servletBean.addUrlMappings(<span class="string">"/zzz"</span>);</span><br><span class="line">        <span class="keyword">return</span> servletBean;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//添加一个监听器</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ServletListenerRegistrationBean <span class="title">myServletListenerRegistrationBean</span><span class="params">()</span></span>&#123;</span><br><span class="line">        ServletListenerRegistrationBean&lt;EventListener&gt; bean = <span class="keyword">new</span> ServletListenerRegistrationBean&lt;&gt;(<span class="keyword">new</span> MyListener());</span><br><span class="line">        <span class="keyword">return</span> bean;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p>SpringBoot帮我们配置了SpringMVC的时候，自动注册了SpringMVC的前端控制器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span>(name = DEFAULT_DISPATCHER_SERVLET_REGISTRATION_BEAN_NAME)</span><br><span class="line"><span class="meta">@ConditionalOnBean</span>(value = DispatcherServlet<span class="class">.<span class="keyword">class</span>, <span class="title">name</span> </span>= DEFAULT_DISPATCHER_SERVLET_BEAN_NAME)</span><br><span class="line"><span class="function"><span class="keyword">public</span> DispatcherServletRegistrationBean <span class="title">dispatcherServletRegistration</span><span class="params">(DispatcherServlet dispatcherServlet,</span></span></span><br><span class="line"><span class="function"><span class="params">      WebMvcProperties webMvcProperties, ObjectProvider&lt;MultipartConfigElement&gt; multipartConfig)</span> </span>&#123;</span><br><span class="line">   DispatcherServletRegistrationBean registration = <span class="keyword">new</span> DispatcherServletRegistrationBean(dispatcherServlet,</span><br><span class="line">         webMvcProperties.getServlet().getPath());</span><br><span class="line">   registration.setName(DEFAULT_DISPATCHER_SERVLET_BEAN_NAME);</span><br><span class="line">   registration.setLoadOnStartup(webMvcProperties.getServlet().getLoadOnStartup());</span><br><span class="line">   multipartConfig.ifAvailable(registration::setMultipartConfig);</span><br><span class="line">   <span class="keyword">return</span> registration;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200513224803286.png" alt="./SpringBoot/https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200513224803286"></p>
<h4 id="十、配置嵌入式Servlet容器-（先跳过）"><a href="#十、配置嵌入式Servlet容器-（先跳过）" class="headerlink" title="十、配置嵌入式Servlet容器==（先跳过）=="></a>十、配置嵌入式Servlet容器==（先跳过）==</h4><p>SpringBoot默认内置了TomCat</p>
<p>怎么使用其他Web容器呢</p>
<p>Jetty（适合长连接）</p>
<p>Undertow（高并发，不支持Jsp）</p>
<p>==先排除TmoCat再引入其他web容器==</p>
<p>SpringBoot嵌入式容器的配置</p>
<h4 id="十一、Docker"><a href="#十一、Docker" class="headerlink" title="十一、Docker"></a>十一、Docker</h4><hr>
<p><img src="https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1589398141261&di=57b7b99b50e19aa5d7060cc16f113079&imgtype=0&src=http%3A%2F%2Fimg3.imgtn.bdimg.com%2Fit%2Fu%3D46204048%2C697885358%26fm%3D214%26gp%3D0.jpg" alt="img"></p>
<h5 id="1-简介"><a href="#1-简介" class="headerlink" title="1.简介"></a>1.简介</h5><p><strong>Docker</strong>是一个开源的应用容器引擎；是一个轻量级容器技术；</p>
<p>Docker支持将软件编译成一个镜像；然后在镜像中各种软件做好配置，将镜像发布出去，其他使用者可以直接使用这个镜像；</p>
<p>运行中的这个镜像称为容器，容器启动是非常快速的。</p>
<h5 id="2-核心概念"><a href="#2-核心概念" class="headerlink" title="2.核心概念"></a>2.核心概念</h5><p>docker主机(Host)：安装了Docker程序的机器（Docker直接安装在操作系统之上）；</p>
<p>docker客户端(Client)：连接docker主机进行操作；</p>
<p>docker仓库(Registry)：用来保存各种打包好的软件镜像；</p>
<p>docker镜像(Images)：软件打包好的镜像；放在docker仓库中；</p>
<p>docker容器(Container)：镜像启动后的实例称为一个容器；容器是独立运行的一个或一组应用</p>
<p><img src="https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200514004528149.png" alt="./SpringBoot/https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200514004528149"></p>
<p>使用Docker的步骤：</p>
<ol>
<li>安装Docker</li>
<li>去Docker仓库找到这个软件对应的镜像；</li>
<li>使用Docker运行这个镜像，这个镜像就会生成一个Docker容器；</li>
<li>对容器的启动停止就是对软件的启动停止；</li>
</ol>
<h5 id="3-安装Docker"><a href="#3-安装Docker" class="headerlink" title="3.安装Docker"></a>3.安装Docker</h5><h6 id="1-安装linux虚拟机"><a href="#1-安装linux虚拟机" class="headerlink" title="1.安装linux虚拟机"></a>1.安装linux虚拟机</h6><ol>
<li>VMWare、VirtualBox（安装）；</li>
<li>导入虚拟机文件centos7-atguigu.ova；</li>
<li>双击启动linux虚拟机;使用  root/ 123456登陆</li>
<li>使用客户端连接linux服务器进行命令操作；</li>
<li>设置虚拟机网络；</li>
<li>桥接网络==选好网卡==接入网线；</li>
<li>设置好网络以后使用命令重启虚拟机的网络</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service network restart</span><br></pre></td></tr></table></figure>

<ol start="8">
<li>查看linux的ip地址</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ip addr</span><br></pre></td></tr></table></figure>

<ol start="9">
<li>使用客户端连接linux；</li>
</ol>
<h6 id="2-安装Docker"><a href="#2-安装Docker" class="headerlink" title="2.安装Docker"></a>2.安装Docker</h6><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">1、检查内核版本，必须是3.10及以上</span><br><span class="line">uname -r</span><br><span class="line">2、安装docker</span><br><span class="line">yum install docker</span><br><span class="line">3、输入y确认安装</span><br><span class="line">4、启动docker</span><br><span class="line">[root@localhost ~]<span class="comment"># systemctl start docker</span></span><br><span class="line">[root@localhost ~]<span class="comment"># docker -v</span></span><br><span class="line">Docker version 1.12.6, build 3e8e77d/1.12.6</span><br><span class="line">5、开机启动docker</span><br><span class="line">[root@localhost ~]<span class="comment"># systemctl enable docker</span></span><br><span class="line">6、停止docker</span><br><span class="line">systemctl stop docker</span><br></pre></td></tr></table></figure>





<h5 id="4-Docker命令"><a href="#4-Docker命令" class="headerlink" title="4.Docker命令"></a>4.Docker命令</h5><table>
<thead>
<tr>
<th>操作</th>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>检索</td>
<td>docker  search 关键字  eg：docker  search redis</td>
<td>我们经常去docker  hub上检索镜像的详细信息，如镜像的TAG。</td>
</tr>
<tr>
<td>拉取</td>
<td>docker pull 镜像名:tag</td>
<td>:tag是可选的，tag表示标签，多为软件的版本，默认是latest</td>
</tr>
<tr>
<td>列表</td>
<td>docker images</td>
<td>查看所有本地镜像</td>
</tr>
<tr>
<td>删除</td>
<td>docker rmi ./SpringBoot/<a href="https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-id" target="_blank" rel="noopener">https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-id</a></td>
<td>删除指定的本地镜像</td>
</tr>
</tbody></table>
<p><strong>查找镜像</strong></p>
<p><strong>docker search mysql</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200514011933205.png" alt="./SpringBoot/https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200514011933205"></p>
<h5 id="5-容器操作"><a href="#5-容器操作" class="headerlink" title="5.容器操作"></a>5.容器操作</h5><table>
<thead>
<tr>
<th>操作</th>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>运行</td>
<td>docker run –name  自定义容器名称              -d   镜像名称</td>
<td>–name：自定义容器名称    -d：后台运行</td>
</tr>
<tr>
<td>容器列表</td>
<td>docker ps</td>
<td>查看运行的中的容器，加  -a  可以查看所有容器</td>
</tr>
<tr>
<td>停止</td>
<td>docker stop 容器名称/容器id</td>
<td>停止当前运行的容器</td>
</tr>
<tr>
<td>启动</td>
<td>docker start 容器名称/容器id</td>
<td>启动容器</td>
</tr>
<tr>
<td>删除</td>
<td>docker rm 容器id</td>
<td>删除容器</td>
</tr>
<tr>
<td>端口映射</td>
<td>-p  映射端口:容器中的端口</td>
<td>docker run -d -p 映射端口:容器中的端口 –name 自定义容器名称 镜像名称</td>
</tr>
<tr>
<td>容器日志</td>
<td>docker loger 容器名称/容器id</td>
<td></td>
</tr>
</tbody></table>
<p><strong>为什么要进行端口映射？</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200514092444065.png" alt="./SpringBoot/https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200514092444065"></p>
<p>在阿里拉取的镜像访问TomCat会出现404，解决方法</p>
<p>docker exec -it mytomcat /bin/bash   </p>
<p>将webapps.dist改为webapps</p>
<p>mv webapps.dist webapps</p>
<h6 id="1-将tomcat添加进容器"><a href="#1-将tomcat添加进容器" class="headerlink" title="1.将tomcat添加进容器"></a>1.将tomcat添加进容器</h6><p> docker run -d -p 8888:8080 –name mytomcat tomcat</p>
<h6 id="2-将MySql添加进容器"><a href="#2-将MySql添加进容器" class="headerlink" title="2.将MySql添加进容器"></a>2.将MySql添加进容器</h6><p>docker run -d -p 3306:3306 –name mysql01 -e MYSQL_ROOT_PASSWORD=183786 mysql</p>
<p><strong>高版本mysql会遇到问题</strong></p>
<p>docker exec -it 容器名</p>
<p>对远程连接进行授权：GRANT ALL ON <em>.</em> TO ‘root’@’%’;</p>
<p>更改密码的加密规则：ALTER USER ‘root’@’%’ IDENTIFIED BY ‘password’ PASSWORD EXPIRE NEVER;</p>
<p>更改root的密码：ALTER USER ‘root’@’%’ IDENTIFIED WITH mysql_native_password BY ‘123456’; </p>
<p>刷新权限：flush privileges;</p>
<h4 id="十二、SpringBoot-amp-JDBC"><a href="#十二、SpringBoot-amp-JDBC" class="headerlink" title="十二、SpringBoot&amp;JDBC"></a>十二、SpringBoot&amp;JDBC</h4><hr>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">'183786'</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://192.168.1.100:3306/jdbc?serverTimezone=UTC</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br></pre></td></tr></table></figure>



<p>效果：</p>
<p>​        默认使用的是com.zaxxer.hikari.HikariDataSource作为数据源</p>
<p>​        数据源所有的相关配置都在DataSourceProperties里面</p>
<p>自动配置原理：</p>
<p>参考DataSourceConfiguration，根据数配置创建数据源，默认使用Hikari数据源，也可以使用spring.datasource.type指定自定义的数据源类型</p>
<p><img src="https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200514182419583.png" alt="./SpringBoot/https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200514182419583"></p>
<p>SpringBoot默认支持的数据源：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200514182513545.png" alt="./SpringBoot/https://cdn.jsdelivr.net/gh/Zmmmmy/Zmmmmy.github.io@master/posts/6f2612a2/image-20200514182513545"></p>
<p>也可以自定义数据源类型</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">T <span class="title">createDataSource</span><span class="params">(DataSourceProperties properties, Class&lt;? extends DataSource&gt; type)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//使用DataSourceBuilder创建数据源，；利用反射创建相应的type数据源并绑定属性</span></span><br><span class="line">   <span class="keyword">return</span> (T) properties.initializeDataSourceBuilder().type(type).build();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="启动程序时加载建表sql"><a href="#启动程序时加载建表sql" class="headerlink" title="启动程序时加载建表sql"></a>启动程序时加载建表sql</h5><p>将sql文件命名为schema-<em>.sql、data-*</em>sql就会自动的执行这些sql文件</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#配置数据源</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://192.168.1.100:3306/jdbc?serverTimezone=GMT</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">'183786'</span></span><br><span class="line">    <span class="comment">#自定义文件</span></span><br><span class="line">    <span class="attr">schema:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">classpath:zmy.sql</span></span><br><span class="line">    <span class="attr">initialization-mode:</span> <span class="string">always</span></span><br></pre></td></tr></table></figure>



<h5 id="整合druid数据源"><a href="#整合druid数据源" class="headerlink" title="整合druid数据源"></a>整合druid数据源</h5><p>引入druid依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.8<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>使用type: com.alibaba.druid.pool.DruidDataSource切换数据源</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://192.168.1.100:3306/jdbc?serverTimezone=GMT</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">'183786'</span></span><br><span class="line">    <span class="attr">schema:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">classpath:zmy.sql</span></span><br><span class="line">    <span class="attr">initialization-mode:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">com.alibaba.druid.pool.DruidDataSource</span></span><br></pre></td></tr></table></figure>

<h6 id="配置监控druid"><a href="#配置监控druid" class="headerlink" title="配置监控druid"></a>配置监控druid</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DruidConfig</span> </span>&#123;</span><br><span class="line">    <span class="meta">@ConfigurationProperties</span>(prefix = <span class="string">"spring.datasource"</span>)</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> DataSource <span class="title">dataSource</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> DruidDataSource();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ServletRegistrationBean&lt;StatViewServlet&gt; <span class="title">bean</span><span class="params">()</span></span>&#123;</span><br><span class="line">        ServletRegistrationBean bean = <span class="keyword">new</span> ServletRegistrationBean&lt;StatViewServlet&gt;(<span class="keyword">new</span> StatViewServlet(),<span class="string">"/druid/*"</span>);</span><br><span class="line">        Map&lt;String ,String&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        map.put(<span class="string">"loginUsername"</span>,<span class="string">"admin"</span>);</span><br><span class="line">        map.put(<span class="string">"loginPassword"</span>,<span class="string">"123456"</span>);</span><br><span class="line">        map.put(<span class="string">"allow"</span>,<span class="string">""</span>);</span><br><span class="line">        bean.setInitParameters(map);</span><br><span class="line">        <span class="keyword">return</span> bean;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> FilterRegistrationBean <span class="title">filterRegistrationBean</span><span class="params">()</span></span>&#123;</span><br><span class="line">        FilterRegistrationBean bean = <span class="keyword">new</span> FilterRegistrationBean();</span><br><span class="line">        bean.setFilter(<span class="keyword">new</span> WebStatFilter());</span><br><span class="line">        Map&lt;String ,String&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        map.put(<span class="string">"exclusions"</span>,<span class="string">"*.js,*.css,/druid/*"</span>);</span><br><span class="line">        bean.setInitParameters(map);</span><br><span class="line">        bean.setUrlPatterns(Arrays.asList(<span class="string">"/*"</span>));</span><br><span class="line">        <span class="keyword">return</span> bean;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="整合MyBatis"><a href="#整合MyBatis" class="headerlink" title="整合MyBatis"></a>整合MyBatis</h5><h6 id="1-配置数据源"><a href="#1-配置数据源" class="headerlink" title="1.配置数据源"></a>1.配置数据源</h6><p>使用druie数据源，配置如上</p>
<h6 id="2-创建数据表"><a href="#2-创建数据表" class="headerlink" title="2.创建数据表"></a>2.创建数据表</h6><h6 id="3-创建实体类"><a href="#3-创建实体类" class="headerlink" title="3.创建实体类"></a>3.创建实体类</h6><h6 id="4-创建mapper"><a href="#4-创建mapper" class="headerlink" title="4.创建mapper"></a>4.创建mapper</h6><p><strong>在查询方法加注解</strong>：@Mapper</p>
<p><strong>或者在主配置类或启动类加</strong>：@MapperScan(value = “com.zmy.mapper”)</p>
<h6 id="自定义MyBatis配置规则"><a href="#自定义MyBatis配置规则" class="headerlink" title="自定义MyBatis配置规则"></a>自定义MyBatis配置规则</h6><p>配置文件</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#开启驼峰命名</span></span><br><span class="line"><span class="attr">mybatis:</span></span><br><span class="line">  <span class="attr">configuration:</span></span><br><span class="line">    <span class="attr">map-underscore-to-camel-case:</span> <span class="literal">false</span></span><br><span class="line"><span class="comment">#添加mapper映射和mybatis的配置文件</span></span><br><span class="line"><span class="attr">mybatis:</span></span><br><span class="line">  <span class="attr">configuration:</span></span><br><span class="line">    <span class="attr">map-underscore-to-camel-case:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">config-location:</span> <span class="string">指定全局配置文件位置</span></span><br><span class="line">  <span class="attr">mapper-locations:</span>   <span class="string">指定mapper映射位置</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//开启驼峰命名</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBatisConfig</span> </span>&#123;</span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ConfigurationCustomizer <span class="title">configurationCustomizer</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ConfigurationCustomizer() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">customize</span><span class="params">(org.apache.ibatis.session.Configuration configuration)</span> </span>&#123;</span><br><span class="line">                configuration.setMapUnderscoreToCamelCase(<span class="keyword">true</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="整合JPA"><a href="#整合JPA" class="headerlink" title="整合JPA"></a>整合JPA</h5><p>编写实体类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span>  <span class="comment">//这是一个实体类</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"tbl_user"</span>) <span class="comment">//对应表名</span></span><br><span class="line"><span class="meta">@JsonIgnoreProperties</span>(value = &#123;<span class="string">"hibernateLazyInitializer"</span>&#125;) <span class="comment">//报500加这个</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Id</span> <span class="comment">//这是一个主键</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span>(strategy = GenerationType.IDENTITY) <span class="comment">//自增主键</span></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"last_name"</span>,length = <span class="number">50</span>) <span class="comment">//和数据表对应的一个列</span></span><br><span class="line">    <span class="keyword">private</span> String lastNmae;</span><br><span class="line">    <span class="meta">@Column</span>  <span class="comment">//省略，列明就是属性名</span></span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>编写dao</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//继承JpaRepository</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserRepository</span> <span class="keyword">extends</span> <span class="title">JpaRepository</span>&lt;<span class="title">User</span>,<span class="title">Integer</span>&gt; </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>配置文件</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://192.168.1.100:3306/jpa?serverTimeZone=GTM</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">'183786'</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line">  <span class="comment">#jpa配置</span></span><br><span class="line">  <span class="attr">jpa:</span></span><br><span class="line">    <span class="attr">hibernate:</span></span><br><span class="line">      <span class="comment">#更新或创建数据表结构</span></span><br><span class="line">      <span class="attr">ddl-auto:</span> <span class="string">update</span></span><br><span class="line">      <span class="comment">#显示sql</span></span><br><span class="line">    <span class="attr">show-sql:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>



<h4 id="十三、SpringBoot启动流程-（先跳过）"><a href="#十三、SpringBoot启动流程-（先跳过）" class="headerlink" title="十三、SpringBoot启动流程==（先跳过）=="></a>十三、SpringBoot启动流程==（先跳过）==</h4><h5 id="1-创建SpringApplication对象"><a href="#1-创建SpringApplication对象" class="headerlink" title="1.创建SpringApplication对象"></a>1.创建SpringApplication对象</h5><h4 id="十四、自定义Starter"><a href="#十四、自定义Starter" class="headerlink" title="十四、自定义Starter"></a>十四、自定义Starter</h4><hr>
<p>如何编写自动配置类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span> <span class="comment">//指定这个类是一个自动配置类</span></span><br><span class="line"><span class="meta">@ConditionalOnXXX</span> <span class="comment">//在指定条件下生效</span></span><br><span class="line"><span class="meta">@AutoConfigureAfter</span> <span class="comment">//指定自动配置类生效顺序</span></span><br><span class="line"><span class="meta">@Bean</span> <span class="comment">//给容器添加组件</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@ConfigurationProperties</span>(prefix = <span class="string">"spring.mvc"</span>) <span class="comment">//结合WebMvcProperties类来绑定相关的配置</span></span><br><span class="line"><span class="meta">@EnableConfigurationProperties</span>(&#123; WebMvcProperties<span class="class">.<span class="keyword">class</span>&#125;) //让<span class="title">WebMvcProperties</span>生效加入到容器中</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">自动配置类加载必须添加进<span class="title">MEAT</span>-<span class="title">INF</span>/<span class="title">spring</span>.<span class="title">factories</span>中</span></span><br></pre></td></tr></table></figure>



<p>模式：</p>
<p>启动器只做依赖导入</p>
<p>专门编写一个自动配置模块</p>
<p>启动器依赖自动配置</p>
<p>自定义启动器名称</p>
<p>步骤：</p>
<p>创建一个空工程</p>
<p>编写一个zmy-spring-boot-starter模块，用来引入zmy-spring-boot-starter-autoconfigurer</p>
<p>编写一个配置类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//设置配置文件前缀</span></span><br><span class="line"><span class="meta">@ConfigurationProperties</span>(prefix = <span class="string">"zmy.hello"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloProperties</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String prefix;</span><br><span class="line">    <span class="keyword">private</span> String suffix;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getPrefix</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> prefix;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPrefix</span><span class="params">(String prefix)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.prefix = prefix;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getSuffix</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> suffix;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSuffix</span><span class="params">(String suffix)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.suffix = suffix;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>编写一个可配置JavaBean</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloService</span> </span>&#123;</span><br><span class="line">    <span class="comment">//引入配置程序</span></span><br><span class="line">    HelloProperties helloProperties;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> HelloProperties <span class="title">getHelloProperties</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> helloProperties;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHelloProperties</span><span class="params">(HelloProperties helloProperties)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.helloProperties = helloProperties;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">(String name)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> helloProperties.getPrefix()+<span class="string">"---"</span>+name+<span class="string">"---"</span>+helloProperties.getSuffix();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>编写一个自动配置程序</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//说明是一个配置类</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="comment">//判断是不是web应用</span></span><br><span class="line"><span class="meta">@ConditionalOnWebApplication</span></span><br><span class="line"><span class="comment">//引入配置文件</span></span><br><span class="line"><span class="meta">@EnableConfigurationProperties</span>(HelloProperties<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">class</span> <span class="title">HelloServiceAutoConfiguration</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    HelloProperties helloProperties;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> HelloService <span class="title">helloService</span><span class="params">()</span></span>&#123;</span><br><span class="line">        HelloService helloService = <span class="keyword">new</span> HelloService();</span><br><span class="line">        helloService.setHelloProperties(helloProperties);</span><br><span class="line">        <span class="keyword">return</span> helloService;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>创建META-INF/spring.factories，让SpringBoot识别</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">org.springframework.boot.autoconfigure.EnableAutoConfiguration</span>=<span class="string">\</span></span><br><span class="line"><span class="attr">com.zmy.starter.HelloServiceAutoConfiguration</span></span><br></pre></td></tr></table></figure>


































          
            <div class='article_footer'>
              
                
  
    
    



  

  
    
    



  

  
    
    

<section class="widget copyright  desktop mobile">
  <div class='content'>
    
      <blockquote>
        
          
            <p>博客内容遵循 署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</p>

          
        
          
            <p>本文永久链接是：<a href=https://zmmmmy.github.io/posts/6f2612a2>https://zmmmmy.github.io/posts/6f2612a2</a></p>
          
        
      </blockquote>
    
  </div>
</section>

  

  
    
    

<section class="widget qrcode  ">
  

  <div class='content article-entry'>
    
      
        <div class='fancybox'><img src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/qrcode/wiki_volantis.png'
        
          height='64px'
        ></div>
      
    
      
        <div class='fancybox'><img src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/qrcode/wiki_volantis.png'
        
          height='64px'
        ></div>
      
    
  </div>
</section>

  


              
            </div>
          
        </div>
        
          


  <section class='meta' id="footer-meta">
    <div class='new-meta-box'>
      
        
          <div class="new-meta-item date" itemprop="dateUpdated" datetime="2020-07-02T13:20:43+08:00">
  <a class='notlink'>
    <i class="fas fa-edit fa-fw" aria-hidden="true"></i>
    <p>更新于：Jul 2, 2020</p>
  </a>
</div>

        
      
        
          
  
  <div class="new-meta-item meta-tags"><a class="tag" href="/tags/Spring/" rel="nofollow"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i><p>Spring</p></a></div>


        
      
        
          

        
      
        
          
  <div class="new-meta-item share -mob-share-list">
  <div class="-mob-share-list share-body">
    
      
        <a class="-mob-share-qq" title="" rel="external nofollow noopener noreferrer"
          
          href="http://connect.qq.com/widget/shareqq/index.html?url=https://zmmmmy.github.io/posts/6f2612a2&title=SpringBoot - 芝麻盐的博客&summary=这是一篇关于SpringBoot的笔记"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/qq.png">
          
        </a>
      
    
      
        <a class="-mob-share-qzone" title="" rel="external nofollow noopener noreferrer"
          
          href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://zmmmmy.github.io/posts/6f2612a2&title=SpringBoot - 芝麻盐的博客&summary=这是一篇关于SpringBoot的笔记"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/qzone.png">
          
        </a>
      
    
      
        <a class="-mob-share-weibo" title="" rel="external nofollow noopener noreferrer"
          
          href="http://service.weibo.com/share/share.php?url=https://zmmmmy.github.io/posts/6f2612a2&title=SpringBoot - 芝麻盐的博客&summary=这是一篇关于SpringBoot的笔记"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/weibo.png">
          
        </a>
      
    
      
        
        <div class='hoverbox'>
          <a><img src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/wechat.png"></a>
          <div class='target'>
            <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARgAAAEYCAAAAACi5bZQAAAC90lEQVR42u3aQXLjMAwEQP//07sPyFYJGJCJkG3ebMsS0bpMAfz8sf65PgjAgAEDBgyYNTCfcH25Yfj/6XOm+/iyHzBgwIABAwbMOphyACpenwJNnz+tBwwYMGDAgAGzF6ZbQFpQGiRPPQcMGDBgwIABAyYNVFWAaVAEAwYMGDBgwIBJYZ4GY9VBWjfQgQEDBgwYMGD+P5jpRp4CWjfoVX9/3SQSDBgwYMCAAfNtMN3VDVjf/TmuBwwYMGDAgAGzBma60gBWvX7ayGrXAwYMGDBgwIBZA5MGpCrUtFF1qgFW3j8YMGDAgAEDZh3MKYju4KtbWBoEr3XwwIABAwYMGDA/BtM9iNMNZGkBpxpU3RcGBgwYMGDAgNkD0x2UTYPhtCFVDZzV/z8mXzBgwIABAwbMGpj2jZobPfX9rUYaGDBgwIABA2Y/zO1GURoIq9dXf28HPDBgwIABAwbMa2C6DaT0gFDamJoO8NrBEwwYMGDAgAGzDmYKkgbFNIil18cnqsCAAQMGDBgwr4NJg9F0EFe9X9roihthYMCAAQMGDJg1MNWglB4YSguYDuLSgAkGDBgwYMCA2QuTDqpuBbB04NYFAgMGDBgwYMDshUlvNB2wpUDpi2kHPDBgwIABAwbMa2HGjZ1h4WlgmwbIx4AHBgwYMGDAgFkD0wW5PTCrXp82ssoBDwwYMGDAgAGzDuZ0I6s7GLsVKMcBDwwYMGDAgAGzBiYFOQWZDv66IGDAgAEDBgyY3wPTLbj84CFYNdB1B3JgwIABAwYMmH0w05UO3NJC0xdRPlAEBgwYMGDAgFkD8wnXtFGUHvypBsXuQBEMGDBgwIABsxemG+hub/B0gCw3sMCAAQMGDBgwa2Gqg6p0wHYq4P34JBIMGDBgwIAB8+thumC3B3KPn8GAAQMGDBgwYA4BdJ/bDXTlgRsYMGDAgAED5vUw3YFbd0NpgbeAwYABAwYMGDD7YU4Prk6D3g6MYMCAAQMGDJh9MBYYMGDAgAEDZtn6CyGP4yxvbrGaAAAAAElFTkSuQmCC">
          </div>
        </div>
      
    
  </div>
</div>



        
      
    </div>
  </section>


        
        
          <div class="prev-next">
            
              <a class='prev' href='/posts/53d0684b'>
                <p class='title'><i class="fas fa-chevron-left" aria-hidden="true"></i>Linux</p>
                <p class='content'>这是一篇关于Linux的笔记


Linux一、Linux的目录结构
二、vi和vim编辑器三种模式1.正常模式

yy：拷贝当前行
5yy：拷贝向下的5行
p：粘贴
dd：删除当前行
5dd：...</p>
              </a>
            
            
              <a class='next' href='/posts/f7d18982'>
                <p class='title'>Hello<i class="fas fa-chevron-right" aria-hidden="true"></i></p>
                <p class='content'>大家好，我是芝麻盐，这是一个乱七八糟的博客</p>
              </a>
            
          </div>
        
      </section>
    </article>
  

  
    <!-- 显示推荐文章和评论 -->



  <article class="post white-box reveal comments shadow">
    <section class="article typo">
      <p ct><i class='fas fa-comments'></i> 评论</p>
      
      
      
      
      
      
        <section id="comments">
          <div id="valine_container" class="valine_thread">
            <i class="fas fa-cog fa-spin fa-fw fa-2x"></i>
          </div>
        </section>
      
      
    </section>
  </article>


  




<!-- 根据页面mathjax变量决定是否加载MathJax数学公式js -->



  <script>
    window.subData = {
      title: 'SpringBoot',
      tools: true
    }
  </script>


</div>
<aside class='l_side'>
  
  

  
    
    



  <section class="widget toc-wrapper shadow desktop mobile" id="toc-div" >
    
  <header>
    
      <i class="fas fa-list fa-fw" aria-hidden="true"></i><span class='name'>本文目录</span>
    
  </header>


    <div class='content'>
        <ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#一、SpringBoot启动类的加载"><span class="toc-text">一、SpringBoot启动类的加载</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#二、配置文件"><span class="toc-text">二、配置文件</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-配置文件"><span class="toc-text">1.配置文件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-YAML-YML"><span class="toc-text">2.YAML(YML)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-ConfigurationProperties-和-Value"><span class="toc-text">3.@ConfigurationProperties  和  @Value</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-PropertySource-和-ImportResource"><span class="toc-text">4.@PropertySource    和    @ImportResource</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-SpringBoot推荐给容器中添加组件的方式"><span class="toc-text">5.SpringBoot推荐给容器中添加组件的方式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#6-配置文件占位符"><span class="toc-text">6.配置文件占位符</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#7-Profile多环境"><span class="toc-text">7.Profile多环境</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#三、SpringBoot的自动配置"><span class="toc-text">三、SpringBoot的自动配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#四、日志"><span class="toc-text">四、日志</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-市面上的日志框架"><span class="toc-text">1.市面上的日志框架</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-SEL4J的使用"><span class="toc-text">2.SEL4J的使用</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-日志的使用"><span class="toc-text">3.日志的使用</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#五、Web开发"><span class="toc-text">五、Web开发</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-SpringBoot对静态资源的映射规则"><span class="toc-text">1.SpringBoot对静态资源的映射规则</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-欢迎页映射"><span class="toc-text">2.欢迎页映射</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-模板引擎"><span class="toc-text">3.模板引擎</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-Spring-MVC自动配置"><span class="toc-text">4.Spring MVC自动配置</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-如何修改SpringBoot的默认配置"><span class="toc-text">&#x3D;&#x3D;5.如何修改SpringBoot的默认配置&#x3D;&#x3D;</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#六、RestfulCRUD"><span class="toc-text">六、RestfulCRUD</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-默认访问首页（视图控制器）"><span class="toc-text">1.默认访问首页（视图控制器）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-国际化"><span class="toc-text">2.国际化</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-登录页面"><span class="toc-text">3.登录页面</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-拦截器"><span class="toc-text">4.拦截器</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-Restful风格"><span class="toc-text">5.Restful风格</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#6-发送PUT-DELETE请求"><span class="toc-text">6.发送PUT,DELETE请求</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#七、错误页面"><span class="toc-text">七、错误页面</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#八、定制错误信息"><span class="toc-text">八、定制错误信息</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-异常处理"><span class="toc-text">1.异常处理</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-如何自适应浏览器和客户端"><span class="toc-text">2.如何自适应浏览器和客户端</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#九、配置嵌入式Servlet容器"><span class="toc-text">九、配置嵌入式Servlet容器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#十、配置嵌入式Servlet容器-（先跳过）"><span class="toc-text">十、配置嵌入式Servlet容器&#x3D;&#x3D;（先跳过）&#x3D;&#x3D;</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#十一、Docker"><span class="toc-text">十一、Docker</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-简介"><span class="toc-text">1.简介</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-核心概念"><span class="toc-text">2.核心概念</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-安装Docker"><span class="toc-text">3.安装Docker</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-Docker命令"><span class="toc-text">4.Docker命令</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-容器操作"><span class="toc-text">5.容器操作</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#十二、SpringBoot-amp-JDBC"><span class="toc-text">十二、SpringBoot&amp;JDBC</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#启动程序时加载建表sql"><span class="toc-text">启动程序时加载建表sql</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#整合druid数据源"><span class="toc-text">整合druid数据源</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#整合MyBatis"><span class="toc-text">整合MyBatis</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#整合JPA"><span class="toc-text">整合JPA</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#十三、SpringBoot启动流程-（先跳过）"><span class="toc-text">十三、SpringBoot启动流程&#x3D;&#x3D;（先跳过）&#x3D;&#x3D;</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-创建SpringApplication对象"><span class="toc-text">1.创建SpringApplication对象</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#十四、自定义Starter"><span class="toc-text">十四、自定义Starter</span></a></li></ol>
    </div>
  </section>


  


</aside>


  
  <footer class="clearfix">
    <br><br>
    
      
        <div class="aplayer-container">
          


        </div>
      
    
      
        <br>
        <div class="social-wrapper">
          
            
              <a href="https://weibo.com/7392244171/profile?topnav=1&amp;wvr=6"
                class="social fab fa-weibo flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
              </a>
            
          
            
              <a href="https://github.com/Zmmmmy"
                class="social fab fa-github flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
              </a>
            
          
            
              <a href="https://music.163.com/#/user/home?id=18747665"
                class="social fas fa-headphones-alt flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
              </a>
            
          
        </div>
      
    
      
        
      
    
      
        <div class='copyright'>
        <p>本站使用 Volantis 作为主题 | <span id="timeDate">载入天数…</span><span id="times">载入时分秒…</span></p>

        </div>
      
    
      
        
          <div><br></div>
        
      
    
      
        
          <div><p><span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span></p>
</div>
        
      
    
  </footer>

<script>setLoadingBarProgress(80);</script>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<!-- <span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span> -->
<span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span>
<script>
    var now = new Date(); 
    function createtime() { 
        var grt= new Date("06/30/2020 22:00:00");//在此处修改你的建站时间，格式：月/日/年 时:分:秒
        now.setTime(now.getTime()+250); 
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days); 
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours); 
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum); 
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;} 
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum); 
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;} 
        document.getElementById("timeDate").innerHTML = "已运行 "+dnum+" 天 "; 
        document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒"; 
    } 
setInterval("createtime()",250);
</script>




      <script>setLoadingBarProgress(60);</script>
    </div>
    <a class="s-top fas fa-arrow-up fa-fw" href='javascript:void(0)'></a>
  </div>
  
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4/dist/jquery.min.js"></script>


  <script>
    
    var SEARCH_SERVICE = "hexo" || "hexo";
    var ROOT = "/" || "/";
    if (!ROOT.endsWith('/')) ROOT += '/';
  </script>





  <script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2/js/instant_page.js" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>


  <script src="https://cdn.jsdelivr.net/npm/scrollreveal@4.0.6/dist/scrollreveal.min.js"></script>
  <script type="text/javascript">
    $(function() {
      ScrollReveal().reveal('.l_main .reveal', {
        distance: '8px',
        duration: '800',
        interval: '100',
        scale: '1'
      });
    });
  </script>


  
<script src="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.js"></script>

  <script type="text/javascript">
    $(function() {
      Waves.attach('.flat-btn', ['waves-button']);
      Waves.attach('.float-btn', ['waves-button', 'waves-float']);
      Waves.attach('.float-btn-light', ['waves-button', 'waves-float', 'waves-light']);
      Waves.attach('.flat-box', ['waves-block']);
      Waves.attach('.float-box', ['waves-block', 'waves-float']);
      Waves.attach('.waves-image');
      Waves.init();
    });
  </script>


  <script defer src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-busuanzi@2.3/js/busuanzi.pure.mini.js"></script>



  
  
  
    
<script src="https://cdn.jsdelivr.net/npm/jquery-backstretch@2.1.18/jquery.backstretch.min.js"></script>

    <script type="text/javascript">
      $(function(){
        var imgs=["https://cdn.jsdelivr.net/gh/Colsrch/images/Wallpaper.png"];
        if ('true' == 'true') {
          function shuffle(arr){
            /*From countercurrent-time*/
            var n = arr.length;
            while(n--) {
              var index = Math.floor(Math.random() * n);
              var temp = arr[index];
              arr[index] = arr[n];
              arr[n] = temp;
            }
          }
          shuffle(imgs);
        }
        if ('') {
          $('').backstretch(
            imgs,
          {
            duration: "20000",
            fade: "1500"
          });
        } else {
          $.backstretch(
            imgs,
          {
            duration: "20000",
            fade: "1500"
          });
        }
      });
    </script>
  











  
    
<script src="https://cdn.jsdelivr.net/npm/valine@1.4/dist/Valine.min.js"></script>

  
  <script>
  var GUEST_INFO = ['nick','mail','link'];
  var meta = 'nick,mail'.split(',').filter(function(item){
    return GUEST_INFO.indexOf(item) > -1
  });
  var REQUIRED_FIELDS = ['nick','mail','link'];
  var requiredFields = 'nick,mail'.split(',').filter(function(item){
    return REQUIRED_FIELDS.indexOf(item) > -1
  });
  var valine = new Valine();
  function emoji(path, idx, ext) {
      return path + "/" + path + "-" + idx + "." + ext;
  }
  var emojiMaps = {};
  for (var i = 1; i <= 54; i++) {
    emojiMaps['tieba-' + i] = emoji('tieba', i, 'png');
  }
  for (var i = 1; i <= 101; i++) {
    emojiMaps['qq-' + i] = emoji('qq', i, 'gif');
  }
  for (var i = 1; i <= 116; i++) {
    emojiMaps['aru-' + i] = emoji('aru', i, 'gif');
  }
  for (var i = 1; i <= 125; i++) {
    emojiMaps['twemoji-' + i] = emoji('twemoji', i, 'png');
  }
  for (var i = 1; i <= 4; i++) {
    emojiMaps['weibo-' + i] = emoji('weibo', i, 'png');
  }
  valine.init({
    el: '#valine_container',
    meta: meta,
    
    appId: "e2yTjLQ241pn3nKO6JBkJ9vL-gzGzoHsz",
    appKey: "jIrelgWguEyhPAychNUkBlU3",
    placeholder: "快来评论吧！记得写昵称和邮箱哦~好让我知道你是谁",
    pageSize:'10',
    avatar:'monsterid',
    lang:'zh-cn',
    visitor: 'true',
    highlight: 'true',
    mathJax: 'false',
    enableQQ: 'true',
    requiredFields: requiredFields,
    emojiCDN: 'https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/emoji/valine/',
    emojiMaps: emojiMaps
  })
  </script>





  
<script src="/js/app.js"></script>



  
<script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2.6.5/js/search.js"></script>



  
<script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2/js/comment_typing.js"></script>






<!-- 复制 -->

  <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="fas fa-copy"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('fa-copy');
        $icon.addClass('fa-check-circle');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('fa-check-circle');
          $icon.addClass('fa-copy');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('fa-copy');
        $icon.addClass('fa-times-circle');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('fa-times-circle');
          $icon.addClass('fa-copy');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>




<!-- fancybox -->
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
<script>
  function pjax_fancybox() {
    $(".article-entry").find("img").not('.inline').not('a img').each(function () { //渲染 fancybox
      var element = document.createElement("a"); // a 标签
      $(element).attr("pjax-fancybox", "");  // 过滤 pjax
      $(element).attr("href", $(this).attr("src"));
      if ($(this).attr("data-original")) {
        $(element).attr("href", $(this).attr("data-original"));
      }
      $(element).attr("data-fancybox", "images");
      var caption = "";   // 描述信息
      if ($(this).attr('alt')) {  // 标准 markdown 描述信息
        $(element).attr('data-caption', $(this).attr('alt'));
        caption = $(this).attr('alt');
      }
      var div = document.createElement("div");
      $(div).addClass("fancybox");
      $(this).wrap(div); // 最外层套 div ，其实主要作用还是 class 样式
      var span = document.createElement("span");
      $(span).addClass("image-caption");
      $(span).text(caption); // 加描述
      $(this).after(span);  // 再套一层描述
      $(this).wrap(element);  // 最后套 a 标签
    })
    $(".article-entry").find("img").fancybox({
      selector: '[data-fancybox="images"]',
      hash: false,
      loop: false,
      closeClick: true,
      helpers: {
        overlay: {closeClick: true}
      },
      buttons: [
        "zoom",
        "close"
      ]
    });
  };
  $(function () {
    pjax_fancybox();
  });
</script>





  <script>setLoadingBarProgress(100);</script>
</body>
</html>
